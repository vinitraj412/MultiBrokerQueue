write_manager  | Traceback (most recent call last):
write_manager  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
write_manager  |     self._dbapi_connection = engine.raw_connection()
write_manager  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
write_manager  |     return self.pool.connect()
write_manager  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
write_manager  |     return _ConnectionFairy._checkout(self)
write_manager  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
write_manager  |     fairy = _ConnectionRecord.checkout(pool)
write_manager  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
write_manager  |     rec = pool._do_get()
write_manager  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
write_manager  |     self._dec_overflow()
write_manager  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
write_manager  |     raise exc_value.with_traceback(exc_tb)
write_manager  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
write_manager  |     return self._create_connection()
write_manager  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
write_manager  |     return _ConnectionRecord(self)
write_manager  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
write_manager  |     self.__connect()
write_manager  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
write_manager  |     pool.logger.debug("Error on connect(): %s", e)
write_manager  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
write_manager     |     raise exc_value.with_traceback(exc_tb)
write_manager     |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
write_manager     |     self.dbapi_connection = connection = pool._invoke_creator(self)
write_manager     |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
write_manager     |     return dialect.connect(*cargs, **cparams)
write_manager     |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
write_manager     |     return self.loaded_dbapi.connect(*cargs, **cparams)
write_manager     |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
write_manager     |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
write_manager     | psycopg2.OperationalError: connection to server at "127.0.0.1", port 5432 failed: Connection refused
write_manager     | 	Is the server running on that host and accepting TCP/IP connections?
write_manager     | 
write_manager     | 
write_manager     | The above exception was the direct cause of the following exception:
write_manager     | 
write_manager     | Traceback (most recent call last):
write_manager     |   File "/app/./ServiceProviders/WMWrapper.py", line 142, in <module>
write_manager     |     db.create_all() # <--- create db object.
write_manager     |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 884, in create_all
write_manager     |     self._call_for_binds(bind_key, "create_all")
write_manager     |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 865, in _call_for_binds
write_manager     |     getattr(metadata, op_name)(bind=engine)
write_manager     |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/schema.py", line 5581, in create_all
write_manager     |     bind._run_ddl_visitor(
write_manager     |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3225, in _run_ddl_visitor
write_manager     |     with self.begin() as conn:
write_manager     |   File "/usr/local/lib/python3.9/contextlib.py", line 119, in __enter__
write_manager     |     return next(self.gen)
write_manager     |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3215, in begin
write_manager     |     with self.connect() as conn:
write_manager     |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3251, in connect
write_manager     |     return self._connection_cls(self)
write_manager     |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
read_manager_one  | Traceback (most recent call last):
read_manager_one  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
read_manager_one  |     self._dbapi_connection = engine.raw_connection()
read_manager_one  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
read_manager_one  |     return self.pool.connect()
read_manager_one  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
db_one            | 
read_manager_one  |     return _ConnectionFairy._checkout(self)
read_manager_two  | Traceback (most recent call last):
read_manager_two  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_two        | Traceback (most recent call last):
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_two        |     self._dbapi_connection = engine.raw_connection()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
read_manager_one  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
read_manager_one  |     fairy = _ConnectionRecord.checkout(pool)
read_manager_two  |     self._dbapi_connection = engine.raw_connection()
read_manager_one  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
read_manager_one  |     rec = pool._do_get()
read_manager_one  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
read_manager_one  |     self._dec_overflow()
read_manager_one  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_two        |     return self.pool.connect()
read_manager_one  |     raise exc_value.with_traceback(exc_tb)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_one        | Traceback (most recent call last):
db_three       | 
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
main_db_one       | The files belonging to this database system will be owned by user "postgres".
broker_one        |     self._dbapi_connection = engine.raw_connection()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_one        |     return self.pool.connect()
db_three          | PostgreSQL Database directory appears to contain a database; Skipping initialization
db_three          | 
db_three          | 2023-03-06 11:25:05.425 UTC [1] LOG:  starting PostgreSQL 13.10 (Debian 13.10-1.pgdg110+1) on x86_64-pc-linux-gnu, compiled by gcc (Debian 10.2.1-6) 10.2.1 20210110, 64-bit
main_db_one       | This user must also own the server process.
db_one            | PostgreSQL Database directory appears to contain a database; Skipping initialization
main_db_one       | 
db_two            | initdb: error: directory "/var/lib/postgresql/data" exists but is not empty
main_db_one       | The database cluster will be initialized with locale "en_US.utf8".
main_db_one       | The default database encoding has accordingly been set to "UTF8".
main_db_one       | The default text search configuration will be set to "english".
main_db_one       | 
main_db_one       | Data page checksums are disabled.
main_db_one       | 
main_db_one       | fixing permissions on existing directory /var/lib/postgresql/data ... ok
main_db_one       | creating subdirectories ... ok
broker_three      | Traceback (most recent call last):
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_three      |     self._dbapi_connection = engine.raw_connection()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_three      |     return self.pool.connect()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_three      |     return _ConnectionFairy._checkout(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_three      |     fairy = _ConnectionRecord.checkout(pool)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_three      |     rec = pool._do_get()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_three      |     self._dec_overflow()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_three      |     raise exc_value.with_traceback(exc_tb)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_three      |     return self._create_connection()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_three      |     return _ConnectionRecord(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_three      |     self.__connect()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_three      |     pool.logger.debug("Error on connect(): %s", e)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_three      |     raise exc_value.with_traceback(exc_tb)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_three      |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_three      |     return dialect.connect(*cargs, **cparams)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_three      |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_three      |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_three      | psycopg2.OperationalError: connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_three      | 	Is the server running on that host and accepting TCP/IP connections?
broker_three      | 
broker_three      | 
broker_three      | The above exception was the direct cause of the following exception:
broker_three      | 
broker_three      | Traceback (most recent call last):
broker_three      |   File "/app/./Brokers/BrokerWrapper.py", line 148, in <module>
broker_three      |     db.create_all()  # <--- create db object.
broker_three      |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 884, in create_all
broker_three      |     self._call_for_binds(bind_key, "create_all")
broker_three      |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 865, in _call_for_binds
db_three          | 2023-03-06 11:25:05.437 UTC [1] LOG:  listening on IPv4 address "0.0.0.0", port 5432
broker_three      |     getattr(metadata, op_name)(bind=engine)
db_three          | 2023-03-06 11:25:05.437 UTC [1] LOG:  listening on IPv6 address "::", port 5432
db_one            | 
read_manager_one  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
write_manager     |     Connection._handle_dbapi_exception_noconnection(
read_manager_one  |     return self._create_connection()
main_db_one       | selecting dynamic shared memory implementation ... posix
main_db_one       | selecting default max_connections ... 100
main_db_one       | selecting default shared_buffers ... 128MB
main_db_one       | selecting default time zone ... Etc/UTC
main_db_one       | creating configuration files ... ok
main_db_one       | running bootstrap script ... ok
main_db_one       | performing post-bootstrap initialization ... ok
main_db_one       | initdb: warning: enabling "trust" authentication for local connections
main_db_one       | syncing data to disk ... ok
main_db_one       | You can change this by editing pg_hba.conf or using the option -A, or
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/schema.py", line 5581, in create_all
write_manager     |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2413, in _handle_dbapi_exception_noconnection
broker_three      |     bind._run_ddl_visitor(
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3225, in _run_ddl_visitor
broker_three      |     with self.begin() as conn:
broker_three      |   File "/usr/local/lib/python3.9/contextlib.py", line 119, in __enter__
read_manager_one  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
read_manager_one  |     return _ConnectionRecord(self)
read_manager_one  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
read_manager_one  |     self.__connect()
read_manager_one  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
read_manager_one  |     pool.logger.debug("Error on connect(): %s", e)
read_manager_one  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
read_manager_one  |     raise exc_value.with_traceback(exc_tb)
read_manager_one  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
read_manager_one  |     self.dbapi_connection = connection = pool._invoke_creator(self)
read_manager_one  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
read_manager_one  |     return dialect.connect(*cargs, **cparams)
read_manager_one  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
read_manager_one  |     return self.loaded_dbapi.connect(*cargs, **cparams)
read_manager_one  |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
read_manager_one  |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
read_manager_one  | psycopg2.OperationalError: connection to server at "127.0.0.1", port 5432 failed: Connection refused
read_manager_one  | 	Is the server running on that host and accepting TCP/IP connections?
read_manager_one  | 
read_manager_one  | 
read_manager_one  | The above exception was the direct cause of the following exception:
read_manager_one  | 
read_manager_one  | Traceback (most recent call last):
broker_two        |     return _ConnectionFairy._checkout(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_two        |     fairy = _ConnectionRecord.checkout(pool)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_two        |     rec = pool._do_get()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_two        |     self._dec_overflow()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_two        |     raise exc_value.with_traceback(exc_tb)
main_db_two       | 
main_db_two       | PostgreSQL Database directory appears to contain a database; Skipping initialization
main_db_two       | 
main_db_two       | 2023-03-06 11:25:05.238 UTC [1] LOG:  starting PostgreSQL 13.10 (Debian 13.10-1.pgdg110+1) on x86_64-pc-linux-gnu, compiled by gcc (Debian 10.2.1-6) 10.2.1 20210110, 64-bit
main_db_two       | 2023-03-06 11:25:05.265 UTC [1] LOG:  listening on IPv4 address "0.0.0.0", port 5432
main_db_two       | 2023-03-06 11:25:05.265 UTC [1] LOG:  listening on IPv6 address "::", port 5432
main_db_two       | 2023-03-06 11:25:05.273 UTC [1] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
main_db_two       | 2023-03-06 11:25:05.283 UTC [27] LOG:  database system was interrupted; last known up at 2023-03-06 11:25:05 UTC
main_db_two       | 2023-03-06 11:25:05.401 UTC [27] LOG:  database system was not properly shut down; automatic recovery in progress
main_db_two       | 2023-03-06 11:25:05.404 UTC [27] LOG:  redo starts at 0/109FA20
main_db_two       | 2023-03-06 11:25:05.488 UTC [27] LOG:  invalid record length at 0/147D4E8: wanted 24, got 0
main_db_two       | 2023-03-06 11:25:05.488 UTC [27] LOG:  redo done at 0/147D480
main_db_two       | 2023-03-06 11:25:05.614 UTC [1] LOG:  database system is ready to accept connections
main_db_two       | 2023-03-06 11:25:15.981 UTC [1] LOG:  received fast shutdown request
main_db_two       | 2023-03-06 11:25:15.984 UTC [1] LOG:  aborting any active transactions
main_db_two       | 2023-03-06 11:25:15.986 UTC [1] LOG:  background worker "logical replication launcher" (PID 33) exited with exit code 1
main_db_two       | 2023-03-06 11:25:15.986 UTC [28] LOG:  shutting down
main_db_two       | 2023-03-06 11:25:16.012 UTC [1] LOG:  database system is shut down
main_db_two       | 
main_db_two       | PostgreSQL Database directory appears to contain a database; Skipping initialization
main_db_two       | 
main_db_two       | 2023-03-06 11:25:58.405 UTC [1] LOG:  starting PostgreSQL 13.10 (Debian 13.10-1.pgdg110+1) on x86_64-pc-linux-gnu, compiled by gcc (Debian 10.2.1-6) 10.2.1 20210110, 64-bit
main_db_two       | 2023-03-06 11:25:58.433 UTC [1] LOG:  listening on IPv4 address "0.0.0.0", port 5432
main_db_two       | 2023-03-06 11:25:58.433 UTC [1] LOG:  listening on IPv6 address "::", port 5432
main_db_two       | 2023-03-06 11:25:58.446 UTC [1] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
main_db_two       | 2023-03-06 11:25:58.457 UTC [27] LOG:  database system was interrupted; last known up at 2023-03-06 11:25:58 UTC
main_db_two       | 2023-03-06 11:25:58.564 UTC [27] LOG:  database system was not properly shut down; automatic recovery in progress
main_db_two       | 2023-03-06 11:25:58.568 UTC [27] LOG:  redo starts at 0/147D5D8
main_db_two       | 2023-03-06 11:25:58.568 UTC [27] LOG:  invalid record length at 0/147D778: wanted 24, got 0
main_db_two       | 2023-03-06 11:25:58.568 UTC [27] LOG:  redo done at 0/147D740
main_db_two       | 2023-03-06 11:25:58.597 UTC [1] LOG:  database system is ready to accept connections
main_db_two       | 2023-03-06 11:26:17.157 UTC [1] LOG:  received fast shutdown request
main_db_two       | 2023-03-06 11:26:17.162 UTC [1] LOG:  aborting any active transactions
main_db_two       | 2023-03-06 11:26:17.164 UTC [1] LOG:  background worker "logical replication launcher" (PID 33) exited with exit code 1
main_db_two       | 2023-03-06 11:26:17.164 UTC [28] LOG:  shutting down
main_db_two       | 2023-03-06 11:26:17.200 UTC [28] PANIC:  could not rename file "pg_logical/replorigin_checkpoint.tmp" to "pg_logical/replorigin_checkpoint": No such file or directory
main_db_two       | 2023-03-06 11:26:17.350 UTC [1] LOG:  checkpointer process (PID 28) was terminated by signal 6: Aborted
main_db_two       | 2023-03-06 11:26:17.350 UTC [1] LOG:  terminating any other active server processes
main_db_two       | 2023-03-06 11:26:17.351 UTC [1] LOG:  abnormal database system shutdown
main_db_two       | 2023-03-06 11:26:17.354 UTC [1] LOG:  database system is shut down
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_two        |     return self._create_connection()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_two        |     return _ConnectionRecord(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_two        |     self.__connect()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_two        |     pool.logger.debug("Error on connect(): %s", e)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_two        |     raise exc_value.with_traceback(exc_tb)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_two        |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_two        |     return dialect.connect(*cargs, **cparams)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_two        |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_two        |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_two        | psycopg2.OperationalError: connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_two        | 	Is the server running on that host and accepting TCP/IP connections?
broker_two        | 
broker_two        | 
broker_two        | The above exception was the direct cause of the following exception:
broker_two        | 
broker_two        | Traceback (most recent call last):
broker_two        |   File "/app/./Brokers/BrokerWrapper.py", line 148, in <module>
broker_two        |     db.create_all()  # <--- create db object.
broker_two        |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 884, in create_all
broker_two        |     self._call_for_binds(bind_key, "create_all")
broker_two        |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 865, in _call_for_binds
broker_two        |     getattr(metadata, op_name)(bind=engine)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/schema.py", line 5581, in create_all
broker_two        |     bind._run_ddl_visitor(
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3225, in _run_ddl_visitor
broker_two        |     with self.begin() as conn:
broker_two        |   File "/usr/local/lib/python3.9/contextlib.py", line 119, in __enter__
broker_two        |     return next(self.gen)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3215, in begin
main_db_one       | 
main_db_one       | --auth-local and --auth-host, the next time you run initdb.
main_db_one       | 
main_db_one       | Success. You can now start the database server using:
main_db_one       | 
main_db_one       |     pg_ctl -D /var/lib/postgresql/data -l logfile start
main_db_one       | 
main_db_one       | pg_ctl: another server might be running; trying to start server anyway
main_db_one       | waiting for server to start....2023-03-06 11:25:05.996 UTC [49] LOG:  starting PostgreSQL 13.10 (Debian 13.10-1.pgdg110+1) on x86_64-pc-linux-gnu, compiled by gcc (Debian 10.2.1-6) 10.2.1 20210110, 64-bit
main_db_one       | 2023-03-06 11:25:06.001 UTC [49] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
main_db_one       | 2023-03-06 11:25:06.026 UTC [50] LOG:  database system was interrupted; last known up at 2023-03-06 11:25:05 UTC
main_db_one       | 2023-03-06 11:25:06.277 UTC [50] LOG:  database system was not properly shut down; automatic recovery in progress
main_db_one       | 2023-03-06 11:25:06.281 UTC [50] LOG:  invalid record length at 0/147D5D8: wanted 24, got 0
main_db_one       | 2023-03-06 11:25:06.281 UTC [50] LOG:  redo is not required
main_db_one       | 2023-03-06 11:25:06.333 UTC [49] LOG:  database system is ready to accept connections
main_db_one       | ..........
main_db_one       | PostgreSQL Database directory appears to contain a database; Skipping initialization
broker_two        |     with self.connect() as conn:
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3251, in connect
broker_two        |     return self._connection_cls(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
broker_two        |     Connection._handle_dbapi_exception_noconnection(
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2413, in _handle_dbapi_exception_noconnection
broker_two        |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_two        |     self._dbapi_connection = engine.raw_connection()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_two        |     return self.pool.connect()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_two        |     return _ConnectionFairy._checkout(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_two        |     fairy = _ConnectionRecord.checkout(pool)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_two        |     rec = pool._do_get()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_two        |     self._dec_overflow()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_two        |     raise exc_value.with_traceback(exc_tb)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_two        |     return self._create_connection()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_two        |     return _ConnectionRecord(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_two        |     self.__connect()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_two        |     pool.logger.debug("Error on connect(): %s", e)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_two        |     raise exc_value.with_traceback(exc_tb)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_two        |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_two        |     return dialect.connect(*cargs, **cparams)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_two        |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_two        |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_two        | sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_two        | 	Is the server running on that host and accepting TCP/IP connections?
broker_two        | 
broker_two        | (Background on this error at: https://sqlalche.me/e/20/e3q8)
broker_two        | Traceback (most recent call last):
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_two        |     self._dbapi_connection = engine.raw_connection()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_two        |     return self.pool.connect()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_two        |     return _ConnectionFairy._checkout(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_two        |     fairy = _ConnectionRecord.checkout(pool)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_two        |     rec = pool._do_get()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_two        |     self._dec_overflow()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_two        |     raise exc_value.with_traceback(exc_tb)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_two        |     return self._create_connection()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_two        |     return _ConnectionRecord(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_two        |     self.__connect()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_two        |     pool.logger.debug("Error on connect(): %s", e)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_two        |     raise exc_value.with_traceback(exc_tb)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_two        |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_two        |     return dialect.connect(*cargs, **cparams)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_two        |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_two        |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_two        | psycopg2.OperationalError: connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_two        | 	Is the server running on that host and accepting TCP/IP connections?
broker_two        | 
broker_two        | 
broker_two        | The above exception was the direct cause of the following exception:
broker_two        | 
broker_two        | Traceback (most recent call last):
broker_two        |   File "/app/./Brokers/BrokerWrapper.py", line 148, in <module>
db_three          | 2023-03-06 11:25:05.445 UTC [1] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
db_three          | 2023-03-06 11:25:05.454 UTC [27] LOG:  database system was interrupted while in recovery at 2023-03-06 11:25:05 UTC
db_three          | 2023-03-06 11:25:05.454 UTC [27] HINT:  This probably means that some data is corrupted and you will have to use the last backup for recovery.
db_three          | 2023-03-06 11:25:05.729 UTC [27] LOG:  could not stat file "./postmaster.pid": No such file or directory
db_three          | 2023-03-06 11:25:05.729 UTC [27] LOG:  database system was not properly shut down; automatic recovery in progress
db_three          | 2023-03-06 11:25:05.734 UTC [27] LOG:  redo starts at 0/109FA20
db_three          | 2023-03-06 11:25:05.785 UTC [27] LOG:  invalid record length at 0/147D560: wanted 24, got 0
db_three          | 2023-03-06 11:25:05.785 UTC [27] LOG:  redo done at 0/147D4E8
db_three          | 2023-03-06 11:25:05.840 UTC [1] LOG:  database system is ready to accept connections
db_three          | 2023-03-06 11:25:05.841 UTC [1] LOG:  could not open file "postmaster.pid": No such file or directory
db_three          | 2023-03-06 11:26:17.173 UTC [1] LOG:  received fast shutdown request
db_three          | 2023-03-06 11:26:17.177 UTC [1] LOG:  aborting any active transactions
db_three          | 2023-03-06 11:26:17.178 UTC [1] LOG:  background worker "logical replication launcher" (PID 33) exited with exit code 1
db_three          | 2023-03-06 11:26:17.186 UTC [28] LOG:  shutting down
db_three          | 2023-03-06 11:26:17.213 UTC [28] PANIC:  could not rename file "pg_logical/replorigin_checkpoint.tmp" to "pg_logical/replorigin_checkpoint": No such file or directory
db_three          | 2023-03-06 11:26:17.367 UTC [1] LOG:  checkpointer process (PID 28) was terminated by signal 6: Aborted
db_three          | 2023-03-06 11:26:17.367 UTC [1] LOG:  terminating any other active server processes
db_three          | 2023-03-06 11:26:17.368 UTC [1] LOG:  abnormal database system shutdown
db_three          | 2023-03-06 11:26:17.370 UTC [1] LOG:  database system is shut down
db_three          | 
db_three          | PostgreSQL Database directory appears to contain a database; Skipping initialization
db_three          | 
db_three          | 2023-03-06 11:27:26.971 UTC [1] LOG:  starting PostgreSQL 13.10 (Debian 13.10-1.pgdg110+1) on x86_64-pc-linux-gnu, compiled by gcc (Debian 10.2.1-6) 10.2.1 20210110, 64-bit
db_three          | 2023-03-06 11:27:26.973 UTC [1] LOG:  listening on IPv4 address "0.0.0.0", port 5432
db_three          | 2023-03-06 11:27:26.973 UTC [1] LOG:  listening on IPv6 address "::", port 5432
db_three          | 2023-03-06 11:27:26.985 UTC [1] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
db_three          | 2023-03-06 11:27:26.999 UTC [27] LOG:  database system was interrupted; last known up at 2023-03-06 11:27:26 UTC
db_three          | 2023-03-06 11:27:27.284 UTC [27] LOG:  database system was not properly shut down; automatic recovery in progress
db_three          | 2023-03-06 11:27:27.288 UTC [27] LOG:  redo starts at 0/147D778
db_three          | 2023-03-06 11:27:27.288 UTC [27] LOG:  invalid record length at 0/147D868: wanted 24, got 0
db_three          | 2023-03-06 11:27:27.288 UTC [27] LOG:  redo done at 0/147D7F0
broker_three      |     return next(self.gen)
main_db_two       | 
main_db_two       | PostgreSQL Database directory appears to contain a database; Skipping initialization
main_db_two       | 
main_db_two       | 2023-03-06 11:27:26.278 UTC [1] LOG:  starting PostgreSQL 13.10 (Debian 13.10-1.pgdg110+1) on x86_64-pc-linux-gnu, compiled by gcc (Debian 10.2.1-6) 10.2.1 20210110, 64-bit
main_db_two       | 2023-03-06 11:27:26.279 UTC [1] LOG:  listening on IPv4 address "0.0.0.0", port 5432
main_db_two       | 2023-03-06 11:27:26.279 UTC [1] LOG:  listening on IPv6 address "::", port 5432
main_db_two       | 2023-03-06 11:27:26.293 UTC [1] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
db_one            | 2023-03-06 11:25:05.953 UTC [1] LOG:  starting PostgreSQL 13.10 (Debian 13.10-1.pgdg110+1) on x86_64-pc-linux-gnu, compiled by gcc (Debian 10.2.1-6) 10.2.1 20210110, 64-bit
read_manager_one  |   File "/app/./ServiceProviders/RMWrapper.py", line 110, in <module>
db_one            | 2023-03-06 11:25:06.009 UTC [1] LOG:  listening on IPv4 address "0.0.0.0", port 5432
read_manager_one  |     db.create_all() # <--- create db object.
read_manager_one  |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 884, in create_all
read_manager_one  |     self._call_for_binds(bind_key, "create_all")
read_manager_one  |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 865, in _call_for_binds
read_manager_one  |     getattr(metadata, op_name)(bind=engine)
read_manager_one  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/schema.py", line 5581, in create_all
read_manager_one  |     bind._run_ddl_visitor(
read_manager_one  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3225, in _run_ddl_visitor
read_manager_one  |     with self.begin() as conn:
read_manager_one  |   File "/usr/local/lib/python3.9/contextlib.py", line 119, in __enter__
read_manager_one  |     return next(self.gen)
reverse_proxy     | /docker-entrypoint.sh: /docker-entrypoint.d/ is not empty, will attempt to perform configuration
reverse_proxy     | /docker-entrypoint.sh: Looking for shell scripts in /docker-entrypoint.d/
reverse_proxy     | /docker-entrypoint.sh: Launching /docker-entrypoint.d/10-listen-on-ipv6-by-default.sh
reverse_proxy     | 10-listen-on-ipv6-by-default.sh: info: Getting the checksum of /etc/nginx/conf.d/default.conf
reverse_proxy     | 10-listen-on-ipv6-by-default.sh: info: Enabled listen on IPv6 in /etc/nginx/conf.d/default.conf
reverse_proxy     | /docker-entrypoint.sh: Launching /docker-entrypoint.d/20-envsubst-on-templates.sh
reverse_proxy     | /docker-entrypoint.sh: Launching /docker-entrypoint.d/30-tune-worker-processes.sh
reverse_proxy     | /docker-entrypoint.sh: Configuration complete; ready for start up
reverse_proxy     | 2023/03/06 11:25:59 [emerg] 1#1: host not found in upstream "read_manager_one:5000" in /etc/nginx/nginx.conf:5
reverse_proxy     | nginx: [emerg] host not found in upstream "read_manager_one:5000" in /etc/nginx/nginx.conf:5
reverse_proxy     | /docker-entrypoint.sh: /docker-entrypoint.d/ is not empty, will attempt to perform configuration
reverse_proxy     | /docker-entrypoint.sh: Looking for shell scripts in /docker-entrypoint.d/
reverse_proxy     | /docker-entrypoint.sh: Launching /docker-entrypoint.d/10-listen-on-ipv6-by-default.sh
reverse_proxy     | 10-listen-on-ipv6-by-default.sh: info: IPv6 listen already enabled
broker_two        |     db.create_all()  # <--- create db object.
broker_two        |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 884, in create_all
broker_two        |     self._call_for_binds(bind_key, "create_all")
broker_two        |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 865, in _call_for_binds
broker_two        |     getattr(metadata, op_name)(bind=engine)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/schema.py", line 5581, in create_all
broker_two        |     bind._run_ddl_visitor(
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3225, in _run_ddl_visitor
main_db_two       | 2023-03-06 11:27:26.305 UTC [27] LOG:  database system was shut down at 2023-03-06 11:26:17 UTC
main_db_two       | 2023-03-06 11:27:26.315 UTC [1] LOG:  database system is ready to accept connections
reverse_proxy     | /docker-entrypoint.sh: Launching /docker-entrypoint.d/20-envsubst-on-templates.sh
reverse_proxy     | /docker-entrypoint.sh: Launching /docker-entrypoint.d/30-tune-worker-processes.sh
reverse_proxy     | /docker-entrypoint.sh: Configuration complete; ready for start up
reverse_proxy     | 2023/03/06 11:27:28 [emerg] 1#1: host not found in upstream "read_manager_two:5000" in /etc/nginx/nginx.conf:6
reverse_proxy     | nginx: [emerg] host not found in upstream "read_manager_two:5000" in /etc/nginx/nginx.conf:6
db_two            | If you want to create a new database system, either remove or empty
db_two            | the directory "/var/lib/postgresql/data" or run initdb
db_two            | with an argument other than "/var/lib/postgresql/data".
db_two            | The files belonging to this database system will be owned by user "postgres".
read_manager_two  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
read_manager_two  |     return self.pool.connect()
read_manager_two  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
read_manager_two  |     return _ConnectionFairy._checkout(self)
read_manager_two  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
read_manager_two  |     fairy = _ConnectionRecord.checkout(pool)
read_manager_two  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
read_manager_two  |     rec = pool._do_get()
read_manager_two  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
read_manager_two  |     self._dec_overflow()
read_manager_two  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
read_manager_two  |     raise exc_value.with_traceback(exc_tb)
read_manager_two  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
main_db_one       | 
main_db_one       | 2023-03-06 11:25:58.130 UTC [1] LOG:  starting PostgreSQL 13.10 (Debian 13.10-1.pgdg110+1) on x86_64-pc-linux-gnu, compiled by gcc (Debian 10.2.1-6) 10.2.1 20210110, 64-bit
main_db_one       | 2023-03-06 11:25:58.136 UTC [1] LOG:  listening on IPv4 address "0.0.0.0", port 5432
main_db_one       | 2023-03-06 11:25:58.136 UTC [1] LOG:  listening on IPv6 address "::", port 5432
main_db_one       | 2023-03-06 11:25:58.144 UTC [1] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
main_db_one       | 2023-03-06 11:25:58.201 UTC [27] LOG:  database system was shut down at 2023-03-06 11:25:15 UTC
main_db_one       | 2023-03-06 11:25:58.212 UTC [1] LOG:  database system is ready to accept connections
main_db_one       | 2023-03-06 11:26:17.160 UTC [1] LOG:  received fast shutdown request
main_db_one       | 2023-03-06 11:26:17.168 UTC [1] LOG:  aborting any active transactions
main_db_one       | 2023-03-06 11:26:17.169 UTC [1] LOG:  background worker "logical replication launcher" (PID 33) exited with exit code 1
main_db_one       | 2023-03-06 11:26:17.169 UTC [28] LOG:  shutting down
main_db_one       | 2023-03-06 11:26:17.217 UTC [1] LOG:  database system is shut down
main_db_one       | 
main_db_one       | PostgreSQL Database directory appears to contain a database; Skipping initialization
broker_two        |     with self.begin() as conn:
broker_two        |   File "/usr/local/lib/python3.9/contextlib.py", line 119, in __enter__
broker_two        |     return next(self.gen)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3215, in begin
broker_two        |     with self.connect() as conn:
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3251, in connect
broker_two        |     return self._connection_cls(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
broker_two        |     Connection._handle_dbapi_exception_noconnection(
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2413, in _handle_dbapi_exception_noconnection
db_two            | This user must also own the server process.
db_two            | 
db_two            | The database cluster will be initialized with locale "en_US.utf8".
db_two            | The default database encoding has accordingly been set to "UTF8".
db_two            | The default text search configuration will be set to "english".
db_two            | 
db_two            | Data page checksums are disabled.
db_two            | 
db_two            | 
db_two            | PostgreSQL Database directory appears to contain a database; Skipping initialization
db_two            | 
db_two            | 2023-03-06 11:25:06.286 UTC [1] LOG:  starting PostgreSQL 13.10 (Debian 13.10-1.pgdg110+1) on x86_64-pc-linux-gnu, compiled by gcc (Debian 10.2.1-6) 10.2.1 20210110, 64-bit
db_two            | 2023-03-06 11:25:06.298 UTC [1] LOG:  listening on IPv4 address "0.0.0.0", port 5432
db_two            | 2023-03-06 11:25:06.298 UTC [1] LOG:  listening on IPv6 address "::", port 5432
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3215, in begin
broker_three      |     with self.connect() as conn:
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3251, in connect
broker_three      |     return self._connection_cls(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
broker_three      |     Connection._handle_dbapi_exception_noconnection(
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2413, in _handle_dbapi_exception_noconnection
broker_three      |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_three      |     self._dbapi_connection = engine.raw_connection()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_three      |     return self.pool.connect()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_three      |     return _ConnectionFairy._checkout(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_three      |     fairy = _ConnectionRecord.checkout(pool)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_three      |     rec = pool._do_get()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_three      |     self._dec_overflow()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_three      |     raise exc_value.with_traceback(exc_tb)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_three      |     return self._create_connection()
db_one            | 2023-03-06 11:25:06.009 UTC [1] LOG:  listening on IPv6 address "::", port 5432
db_two            | 2023-03-06 11:25:06.314 UTC [1] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
db_two            | 2023-03-06 11:25:06.331 UTC [29] LOG:  database system was interrupted; last known up at 2023-03-06 11:25:05 UTC
db_two            | 2023-03-06 11:25:06.490 UTC [29] LOG:  database system was not properly shut down; automatic recovery in progress
db_two            | 2023-03-06 11:25:06.494 UTC [29] LOG:  redo starts at 0/147D5D8
db_two            | 2023-03-06 11:25:06.494 UTC [29] LOG:  invalid record length at 0/147D6C8: wanted 24, got 0
db_two            | 2023-03-06 11:25:06.494 UTC [29] LOG:  redo done at 0/147D650
db_two            | 2023-03-06 11:25:06.539 UTC [1] LOG:  database system is ready to accept connections
db_two            | 2023-03-06 11:26:17.178 UTC [1] LOG:  received fast shutdown request
db_two            | 2023-03-06 11:26:17.183 UTC [1] LOG:  aborting any active transactions
db_two            | 2023-03-06 11:26:17.185 UTC [1] LOG:  background worker "logical replication launcher" (PID 35) exited with exit code 1
db_two            | 2023-03-06 11:26:17.185 UTC [30] LOG:  shutting down
db_two            | 2023-03-06 11:26:17.207 UTC [30] PANIC:  could not create file "pg_logical/replorigin_checkpoint.tmp": File exists
db_one            | 2023-03-06 11:25:06.032 UTC [1] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
db_one            | 2023-03-06 11:25:06.054 UTC [27] LOG:  database system was interrupted; last known up at 2023-03-06 11:25:05 UTC
db_one            | 2023-03-06 11:25:06.322 UTC [27] LOG:  database system was not properly shut down; automatic recovery in progress
db_one            | 2023-03-06 11:25:06.330 UTC [27] LOG:  redo starts at 0/147D5D8
db_one            | 2023-03-06 11:25:06.330 UTC [27] LOG:  invalid record length at 0/147D650: wanted 24, got 0
db_one            | 2023-03-06 11:25:06.330 UTC [27] LOG:  redo done at 0/147D5D8
db_one            | 2023-03-06 11:25:06.373 UTC [1] LOG:  database system is ready to accept connections
db_one            | 2023-03-06 11:26:17.178 UTC [1] LOG:  received fast shutdown request
db_one            | 2023-03-06 11:26:17.183 UTC [1] LOG:  aborting any active transactions
db_one            | 2023-03-06 11:26:17.185 UTC [1] LOG:  background worker "logical replication launcher" (PID 33) exited with exit code 1
db_one            | 2023-03-06 11:26:17.185 UTC [28] LOG:  shutting down
db_one            | 2023-03-06 11:26:17.230 UTC [1] LOG:  database system is shut down
db_one            | 
main_db_one       | 
main_db_one       | 2023-03-06 11:27:26.723 UTC [1] LOG:  starting PostgreSQL 13.10 (Debian 13.10-1.pgdg110+1) on x86_64-pc-linux-gnu, compiled by gcc (Debian 10.2.1-6) 10.2.1 20210110, 64-bit
main_db_one       | 2023-03-06 11:27:26.741 UTC [1] LOG:  listening on IPv4 address "0.0.0.0", port 5432
main_db_one       | 2023-03-06 11:27:26.741 UTC [1] LOG:  listening on IPv6 address "::", port 5432
main_db_one       | 2023-03-06 11:27:26.749 UTC [1] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
main_db_one       | 2023-03-06 11:27:26.848 UTC [27] LOG:  database system was interrupted; last known up at 2023-03-06 11:27:26 UTC
main_db_one       | 2023-03-06 11:27:27.160 UTC [27] LOG:  database system was not properly shut down; automatic recovery in progress
main_db_one       | 2023-03-06 11:27:27.170 UTC [27] LOG:  redo starts at 0/147D778
main_db_one       | 2023-03-06 11:27:27.170 UTC [27] LOG:  invalid record length at 0/147D7F0: wanted 24, got 0
main_db_one       | 2023-03-06 11:27:27.170 UTC [27] LOG:  redo done at 0/147D778
write_manager     |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
db_two            | 2023-03-06 11:26:17.384 UTC [1] LOG:  checkpointer process (PID 30) was terminated by signal 6: Aborted
db_two            | 2023-03-06 11:26:17.384 UTC [1] LOG:  terminating any other active server processes
db_two            | 2023-03-06 11:26:17.385 UTC [1] LOG:  abnormal database system shutdown
db_two            | 2023-03-06 11:26:17.387 UTC [1] LOG:  database system is shut down
db_two            | 
db_two            | PostgreSQL Database directory appears to contain a database; Skipping initialization
db_two            | 
db_two            | 2023-03-06 11:27:26.818 UTC [1] LOG:  starting PostgreSQL 13.10 (Debian 13.10-1.pgdg110+1) on x86_64-pc-linux-gnu, compiled by gcc (Debian 10.2.1-6) 10.2.1 20210110, 64-bit
db_two            | 2023-03-06 11:27:26.866 UTC [1] LOG:  listening on IPv4 address "0.0.0.0", port 5432
db_two            | 2023-03-06 11:27:26.866 UTC [1] LOG:  listening on IPv6 address "::", port 5432
db_two            | 2023-03-06 11:27:26.875 UTC [1] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
db_two            | 2023-03-06 11:27:26.886 UTC [26] LOG:  database system was interrupted; last known up at 2023-03-06 11:27:26 UTC
read_manager_two  |     return self._create_connection()
read_manager_two  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
read_manager_two  |     return _ConnectionRecord(self)
read_manager_two  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
read_manager_two  |     self.__connect()
read_manager_two  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
read_manager_two  |     pool.logger.debug("Error on connect(): %s", e)
read_manager_two  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
write_manager     |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
read_manager_two  |     raise exc_value.with_traceback(exc_tb)
read_manager_two  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
read_manager_two  |     self.dbapi_connection = connection = pool._invoke_creator(self)
read_manager_two  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
read_manager_two  |     return dialect.connect(*cargs, **cparams)
read_manager_two  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
read_manager_two  |     return self.loaded_dbapi.connect(*cargs, **cparams)
read_manager_two  |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
read_manager_two  |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
db_three          | 2023-03-06 11:27:27.314 UTC [1] LOG:  database system is ready to accept connections
read_manager_two  | psycopg2.OperationalError: connection to server at "127.0.0.1", port 5432 failed: Connection refused
read_manager_two  | 	Is the server running on that host and accepting TCP/IP connections?
read_manager_two  | 
read_manager_two  | 
read_manager_two  | The above exception was the direct cause of the following exception:
read_manager_two  | 
read_manager_two  | Traceback (most recent call last):
read_manager_two  |   File "/app/./ServiceProviders/RMWrapper.py", line 110, in <module>
read_manager_two  |     db.create_all() # <--- create db object.
read_manager_two  |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 884, in create_all
read_manager_two  |     self._call_for_binds(bind_key, "create_all")
read_manager_two  |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 865, in _call_for_binds
read_manager_two  |     getattr(metadata, op_name)(bind=engine)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
read_manager_two  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/schema.py", line 5581, in create_all
read_manager_two  |     bind._run_ddl_visitor(
read_manager_two  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3225, in _run_ddl_visitor
read_manager_two  |     with self.begin() as conn:
read_manager_two  |   File "/usr/local/lib/python3.9/contextlib.py", line 119, in __enter__
read_manager_two  |     return next(self.gen)
read_manager_two  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3215, in begin
read_manager_two  |     with self.connect() as conn:
read_manager_two  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3251, in connect
read_manager_two  |     return self._connection_cls(self)
read_manager_two  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
read_manager_two  |     Connection._handle_dbapi_exception_noconnection(
read_manager_two  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2413, in _handle_dbapi_exception_noconnection
read_manager_one  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3215, in begin
read_manager_one  |     with self.connect() as conn:
read_manager_one  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3251, in connect
read_manager_one  |     return self._connection_cls(self)
read_manager_one  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
read_manager_one  |     Connection._handle_dbapi_exception_noconnection(
read_manager_one  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2413, in _handle_dbapi_exception_noconnection
read_manager_one  |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
read_manager_one  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
read_manager_one  |     self._dbapi_connection = engine.raw_connection()
read_manager_one  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_two        |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
write_manager     |     self._dbapi_connection = engine.raw_connection()
write_manager     |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
write_manager     |     return self.pool.connect()
write_manager     |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
write_manager     |     return _ConnectionFairy._checkout(self)
write_manager     |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
write_manager     |     fairy = _ConnectionRecord.checkout(pool)
write_manager     |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
write_manager     |     rec = pool._do_get()
write_manager     |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
write_manager     |     self._dec_overflow()
write_manager     |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
read_manager_two  |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
read_manager_two  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
read_manager_two  |     self._dbapi_connection = engine.raw_connection()
read_manager_two  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
read_manager_two  |     return self.pool.connect()
read_manager_two  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
read_manager_two  |     return _ConnectionFairy._checkout(self)
read_manager_two  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
read_manager_two  |     fairy = _ConnectionRecord.checkout(pool)
read_manager_two  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
read_manager_two  |     rec = pool._do_get()
read_manager_two  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
read_manager_two  |     self._dec_overflow()
read_manager_two  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
read_manager_two  |     raise exc_value.with_traceback(exc_tb)
db_two            | 2023-03-06 11:27:27.131 UTC [26] LOG:  database system was not properly shut down; automatic recovery in progress
db_two            | 2023-03-06 11:27:27.135 UTC [26] LOG:  invalid record length at 0/147D778: wanted 24, got 0
db_two            | 2023-03-06 11:27:27.135 UTC [26] LOG:  redo is not required
db_two            | 2023-03-06 11:27:27.187 UTC [1] LOG:  database system is ready to accept connections
main_db_one       | 2023-03-06 11:27:27.217 UTC [1] LOG:  database system is ready to accept connections
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_one        |     return _ConnectionFairy._checkout(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_one        |     fairy = _ConnectionRecord.checkout(pool)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_one        |     rec = pool._do_get()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_one        |     self._dec_overflow()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_one        |     raise exc_value.with_traceback(exc_tb)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_one        |     return self._create_connection()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_one        |     return _ConnectionRecord(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_one        |     self.__connect()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_one        |     pool.logger.debug("Error on connect(): %s", e)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_one        |     raise exc_value.with_traceback(exc_tb)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_one        |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_one        |     return dialect.connect(*cargs, **cparams)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_one        |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_one        |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_one        | psycopg2.OperationalError: connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_one        | 	Is the server running on that host and accepting TCP/IP connections?
broker_one        | 
broker_three      |     return _ConnectionRecord(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_three      |     self.__connect()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_three      |     pool.logger.debug("Error on connect(): %s", e)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_three      |     raise exc_value.with_traceback(exc_tb)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_three      |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_three      |     return dialect.connect(*cargs, **cparams)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
write_manager     |     raise exc_value.with_traceback(exc_tb)
write_manager     |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
write_manager     |     return self._create_connection()
write_manager     |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
write_manager     |     return _ConnectionRecord(self)
write_manager     |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
write_manager     |     self.__connect()
write_manager     |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
write_manager     |     pool.logger.debug("Error on connect(): %s", e)
write_manager     |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
write_manager     |     raise exc_value.with_traceback(exc_tb)
write_manager     |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_one        | 
broker_one        | The above exception was the direct cause of the following exception:
broker_one        | 
broker_one        | Traceback (most recent call last):
broker_one        |   File "/app/./Brokers/BrokerWrapper.py", line 148, in <module>
broker_one        |     db.create_all()  # <--- create db object.
broker_one        |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 884, in create_all
broker_one        |     self._call_for_binds(bind_key, "create_all")
broker_one        |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 865, in _call_for_binds
broker_one        |     getattr(metadata, op_name)(bind=engine)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/schema.py", line 5581, in create_all
broker_one        |     bind._run_ddl_visitor(
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3225, in _run_ddl_visitor
broker_one        |     with self.begin() as conn:
broker_one        |   File "/usr/local/lib/python3.9/contextlib.py", line 119, in __enter__
broker_one        |     return next(self.gen)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3215, in begin
broker_one        |     with self.connect() as conn:
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3251, in connect
broker_one        |     return self._connection_cls(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
broker_one        |     Connection._handle_dbapi_exception_noconnection(
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2413, in _handle_dbapi_exception_noconnection
broker_one        |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_one        |     self._dbapi_connection = engine.raw_connection()
broker_three      |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_three      |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_three      | sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_three      | 	Is the server running on that host and accepting TCP/IP connections?
broker_three      | 
broker_three      | (Background on this error at: https://sqlalche.me/e/20/e3q8)
broker_three      | Traceback (most recent call last):
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_three      |     self._dbapi_connection = engine.raw_connection()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_three      |     return self.pool.connect()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
db_one            | PostgreSQL Database directory appears to contain a database; Skipping initialization
db_one            | 
db_one            | 2023-03-06 11:27:26.283 UTC [1] LOG:  starting PostgreSQL 13.10 (Debian 13.10-1.pgdg110+1) on x86_64-pc-linux-gnu, compiled by gcc (Debian 10.2.1-6) 10.2.1 20210110, 64-bit
db_one            | 2023-03-06 11:27:26.283 UTC [1] LOG:  listening on IPv4 address "0.0.0.0", port 5432
db_one            | 2023-03-06 11:27:26.284 UTC [1] LOG:  listening on IPv6 address "::", port 5432
db_one            | 2023-03-06 11:27:26.301 UTC [1] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
db_one            | 2023-03-06 11:27:26.315 UTC [27] LOG:  database system was shut down at 2023-03-06 11:26:17 UTC
db_one            | 2023-03-06 11:27:26.326 UTC [1] LOG:  database system is ready to accept connections
read_manager_one  |     return self.pool.connect()
read_manager_one  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
read_manager_one  |     return _ConnectionFairy._checkout(self)
read_manager_one  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
read_manager_one  |     fairy = _ConnectionRecord.checkout(pool)
read_manager_one  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
read_manager_one  |     rec = pool._do_get()
read_manager_one  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
read_manager_one  |     self._dec_overflow()
read_manager_one  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
read_manager_one  |     raise exc_value.with_traceback(exc_tb)
read_manager_one  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
read_manager_one  |     return self._create_connection()
read_manager_one  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
read_manager_one  |     return _ConnectionRecord(self)
read_manager_one  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
read_manager_one  |     self.__connect()
read_manager_one  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
read_manager_one  |     pool.logger.debug("Error on connect(): %s", e)
read_manager_one  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_three      |     return _ConnectionFairy._checkout(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_three      |     fairy = _ConnectionRecord.checkout(pool)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_three      |     rec = pool._do_get()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_three      |     self._dec_overflow()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_three      |     raise exc_value.with_traceback(exc_tb)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_three      |     return self._create_connection()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_three      |     return _ConnectionRecord(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_one        |     return self.pool.connect()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_one        |     return _ConnectionFairy._checkout(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_one        |     fairy = _ConnectionRecord.checkout(pool)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_one        |     rec = pool._do_get()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
read_manager_two  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
read_manager_two  |     return self._create_connection()
read_manager_two  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
read_manager_two  |     return _ConnectionRecord(self)
read_manager_two  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
read_manager_two  |     self.__connect()
read_manager_two  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
read_manager_two  |     pool.logger.debug("Error on connect(): %s", e)
read_manager_two  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
read_manager_two  |     raise exc_value.with_traceback(exc_tb)
read_manager_two  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
read_manager_two  |     self.dbapi_connection = connection = pool._invoke_creator(self)
read_manager_two  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
read_manager_one  |     raise exc_value.with_traceback(exc_tb)
read_manager_one  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
read_manager_one  |     self.dbapi_connection = connection = pool._invoke_creator(self)
read_manager_one  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
read_manager_one  |     return dialect.connect(*cargs, **cparams)
read_manager_one  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
read_manager_one  |     return self.loaded_dbapi.connect(*cargs, **cparams)
read_manager_one  |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
read_manager_one  |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
read_manager_one  | sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "127.0.0.1", port 5432 failed: Connection refused
read_manager_one  | 	Is the server running on that host and accepting TCP/IP connections?
read_manager_one  | 
read_manager_one  | (Background on this error at: https://sqlalche.me/e/20/e3q8)
write_manager     |     self.dbapi_connection = connection = pool._invoke_creator(self)
write_manager     |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
write_manager     |     return dialect.connect(*cargs, **cparams)
write_manager     |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
write_manager     |     return self.loaded_dbapi.connect(*cargs, **cparams)
write_manager     |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
write_manager     |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
write_manager     | sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "127.0.0.1", port 5432 failed: Connection refused
write_manager     | 	Is the server running on that host and accepting TCP/IP connections?
write_manager     | 
broker_one        |     self._dec_overflow()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_one        |     raise exc_value.with_traceback(exc_tb)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_one        |     return self._create_connection()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_one        |     return _ConnectionRecord(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_one        |     self.__connect()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_one        |     pool.logger.debug("Error on connect(): %s", e)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_one        |     raise exc_value.with_traceback(exc_tb)
read_manager_one  | Traceback (most recent call last):
read_manager_one  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
read_manager_one  |     self._dbapi_connection = engine.raw_connection()
read_manager_one  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
read_manager_one  |     return self.pool.connect()
read_manager_one  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
read_manager_one  |     return _ConnectionFairy._checkout(self)
read_manager_one  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
read_manager_one  |     fairy = _ConnectionRecord.checkout(pool)
read_manager_one  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
read_manager_one  |     rec = pool._do_get()
read_manager_one  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
read_manager_one  |     self._dec_overflow()
broker_two        |     self._dbapi_connection = engine.raw_connection()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_two        |     return self.pool.connect()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_two        |     return _ConnectionFairy._checkout(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_two        |     fairy = _ConnectionRecord.checkout(pool)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_two        |     rec = pool._do_get()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_two        |     self._dec_overflow()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_two        |     raise exc_value.with_traceback(exc_tb)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_two        |     return self._create_connection()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_two        |     return _ConnectionRecord(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_two        |     self.__connect()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_two        |     pool.logger.debug("Error on connect(): %s", e)
read_manager_two  |     return dialect.connect(*cargs, **cparams)
read_manager_two  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
read_manager_two  |     return self.loaded_dbapi.connect(*cargs, **cparams)
read_manager_two  |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
read_manager_two  |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
read_manager_two  | sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "127.0.0.1", port 5432 failed: Connection refused
read_manager_two  | 	Is the server running on that host and accepting TCP/IP connections?
read_manager_two  | 
read_manager_two  | (Background on this error at: https://sqlalche.me/e/20/e3q8)
read_manager_two  | Traceback (most recent call last):
read_manager_two  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
read_manager_two  |     self._dbapi_connection = engine.raw_connection()
read_manager_two  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
read_manager_two  |     return self.pool.connect()
read_manager_two  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
read_manager_two  |     return _ConnectionFairy._checkout(self)
read_manager_two  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
read_manager_two  |     fairy = _ConnectionRecord.checkout(pool)
read_manager_two  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
read_manager_two  |     rec = pool._do_get()
read_manager_two  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
read_manager_two  |     self._dec_overflow()
read_manager_two  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
read_manager_two  |     raise exc_value.with_traceback(exc_tb)
read_manager_two  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
write_manager     | (Background on this error at: https://sqlalche.me/e/20/e3q8)
write_manager     | Traceback (most recent call last):
write_manager     |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
write_manager     |     self._dbapi_connection = engine.raw_connection()
write_manager     |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
write_manager     |     return self.pool.connect()
write_manager     |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
write_manager     |     return _ConnectionFairy._checkout(self)
write_manager     |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
write_manager     |     fairy = _ConnectionRecord.checkout(pool)
write_manager     |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
write_manager     |     rec = pool._do_get()
write_manager     |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
write_manager     |     self._dec_overflow()
write_manager     |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
write_manager     |     raise exc_value.with_traceback(exc_tb)
write_manager     |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
write_manager     |     return self._create_connection()
write_manager     |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
write_manager     |     return _ConnectionRecord(self)
write_manager     |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
write_manager     |     self.__connect()
write_manager     |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
write_manager     |     pool.logger.debug("Error on connect(): %s", e)
write_manager     |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
write_manager     |     raise exc_value.with_traceback(exc_tb)
write_manager     |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
write_manager     |     self.dbapi_connection = connection = pool._invoke_creator(self)
write_manager     |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
read_manager_one  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
read_manager_one  |     raise exc_value.with_traceback(exc_tb)
read_manager_one  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
read_manager_one  |     return self._create_connection()
read_manager_one  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
read_manager_one  |     return _ConnectionRecord(self)
read_manager_one  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
read_manager_one  |     self.__connect()
read_manager_one  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
read_manager_one  |     pool.logger.debug("Error on connect(): %s", e)
read_manager_one  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
read_manager_one  |     raise exc_value.with_traceback(exc_tb)
read_manager_one  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_three      |     self.__connect()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_three      |     pool.logger.debug("Error on connect(): %s", e)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_three      |     raise exc_value.with_traceback(exc_tb)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_three      |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_three      |     return dialect.connect(*cargs, **cparams)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_three      |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
write_manager     |     return dialect.connect(*cargs, **cparams)
write_manager     |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
write_manager     |     return self.loaded_dbapi.connect(*cargs, **cparams)
write_manager     |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
write_manager     |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
write_manager     | psycopg2.OperationalError: connection to server at "127.0.0.1", port 5432 failed: Connection refused
write_manager     | 	Is the server running on that host and accepting TCP/IP connections?
write_manager     | 
write_manager     | 
write_manager     | The above exception was the direct cause of the following exception:
write_manager     | 
write_manager     | Traceback (most recent call last):
write_manager     |   File "/app/./ServiceProviders/WMWrapper.py", line 142, in <module>
write_manager     |     db.create_all() # <--- create db object.
broker_two        |     raise exc_value.with_traceback(exc_tb)
read_manager_two  |     return self._create_connection()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_two        |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_two        |     return dialect.connect(*cargs, **cparams)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_two        |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_two        |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
write_manager     |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 884, in create_all
write_manager     |     self._call_for_binds(bind_key, "create_all")
write_manager     |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 865, in _call_for_binds
write_manager     |     getattr(metadata, op_name)(bind=engine)
write_manager     |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/schema.py", line 5581, in create_all
write_manager     |     bind._run_ddl_visitor(
write_manager     |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3225, in _run_ddl_visitor
write_manager     |     with self.begin() as conn:
write_manager     |   File "/usr/local/lib/python3.9/contextlib.py", line 119, in __enter__
write_manager     |     return next(self.gen)
write_manager     |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3215, in begin
write_manager     |     with self.connect() as conn:
write_manager     |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3251, in connect
read_manager_two  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
read_manager_two  |     return _ConnectionRecord(self)
read_manager_two  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
read_manager_two  |     self.__connect()
read_manager_two  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
read_manager_two  |     pool.logger.debug("Error on connect(): %s", e)
read_manager_two  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
read_manager_two  |     raise exc_value.with_traceback(exc_tb)
read_manager_two  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
read_manager_two  |     self.dbapi_connection = connection = pool._invoke_creator(self)
read_manager_two  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
read_manager_two  |     return dialect.connect(*cargs, **cparams)
read_manager_two  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
read_manager_two  |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_three      |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_three      | psycopg2.OperationalError: connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_three      | 	Is the server running on that host and accepting TCP/IP connections?
broker_three      | 
broker_three      | 
broker_three      | The above exception was the direct cause of the following exception:
broker_three      | 
broker_three      | Traceback (most recent call last):
broker_three      |   File "/app/./Brokers/BrokerWrapper.py", line 148, in <module>
broker_three      |     db.create_all()  # <--- create db object.
broker_three      |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 884, in create_all
broker_three      |     self._call_for_binds(bind_key, "create_all")
broker_three      |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 865, in _call_for_binds
broker_three      |     getattr(metadata, op_name)(bind=engine)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/schema.py", line 5581, in create_all
broker_three      |     bind._run_ddl_visitor(
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3225, in _run_ddl_visitor
broker_three      |     with self.begin() as conn:
broker_three      |   File "/usr/local/lib/python3.9/contextlib.py", line 119, in __enter__
broker_three      |     return next(self.gen)
broker_two        | sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_two        | 	Is the server running on that host and accepting TCP/IP connections?
broker_two        | 
broker_two        | (Background on this error at: https://sqlalche.me/e/20/e3q8)
broker_two        | Traceback (most recent call last):
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_two        |     self._dbapi_connection = engine.raw_connection()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_two        |     return self.pool.connect()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_two        |     return _ConnectionFairy._checkout(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_two        |     fairy = _ConnectionRecord.checkout(pool)
read_manager_two  |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
read_manager_two  |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
read_manager_two  | psycopg2.OperationalError: connection to server at "127.0.0.1", port 5432 failed: Connection refused
read_manager_two  | 	Is the server running on that host and accepting TCP/IP connections?
read_manager_two  | 
read_manager_two  | 
read_manager_two  | The above exception was the direct cause of the following exception:
read_manager_two  | 
read_manager_two  | Traceback (most recent call last):
read_manager_two  |   File "/app/./ServiceProviders/RMWrapper.py", line 110, in <module>
read_manager_two  |     db.create_all() # <--- create db object.
read_manager_two  |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 884, in create_all
read_manager_two  |     self._call_for_binds(bind_key, "create_all")
read_manager_two  |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 865, in _call_for_binds
write_manager     |     return self._connection_cls(self)
write_manager     |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
write_manager     |     Connection._handle_dbapi_exception_noconnection(
write_manager     |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2413, in _handle_dbapi_exception_noconnection
write_manager     |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
write_manager     |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
write_manager     |     self._dbapi_connection = engine.raw_connection()
write_manager     |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
write_manager     |     return self.pool.connect()
write_manager     |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
write_manager     |     return _ConnectionFairy._checkout(self)
write_manager     |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
write_manager     |     fairy = _ConnectionRecord.checkout(pool)
write_manager     |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_one        |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_one        |     return dialect.connect(*cargs, **cparams)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_one        |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_one        |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_one        | sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_one        | 	Is the server running on that host and accepting TCP/IP connections?
broker_one        | 
broker_one        | (Background on this error at: https://sqlalche.me/e/20/e3q8)
broker_one        | Traceback (most recent call last):
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_one        |     self._dbapi_connection = engine.raw_connection()
read_manager_two  |     getattr(metadata, op_name)(bind=engine)
read_manager_two  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/schema.py", line 5581, in create_all
read_manager_two  |     bind._run_ddl_visitor(
read_manager_two  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3225, in _run_ddl_visitor
read_manager_two  |     with self.begin() as conn:
read_manager_two  |   File "/usr/local/lib/python3.9/contextlib.py", line 119, in __enter__
read_manager_two  |     return next(self.gen)
read_manager_two  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3215, in begin
read_manager_two  |     with self.connect() as conn:
read_manager_two  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3251, in connect
read_manager_two  |     return self._connection_cls(self)
read_manager_two  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
read_manager_two  |     Connection._handle_dbapi_exception_noconnection(
read_manager_two  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2413, in _handle_dbapi_exception_noconnection
read_manager_two  |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
read_manager_one  |     self.dbapi_connection = connection = pool._invoke_creator(self)
read_manager_one  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
read_manager_one  |     return dialect.connect(*cargs, **cparams)
read_manager_one  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
read_manager_one  |     return self.loaded_dbapi.connect(*cargs, **cparams)
read_manager_one  |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
read_manager_one  |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
read_manager_one  | psycopg2.OperationalError: connection to server at "127.0.0.1", port 5432 failed: Connection refused
read_manager_one  | 	Is the server running on that host and accepting TCP/IP connections?
read_manager_one  | 
read_manager_one  | 
read_manager_one  | The above exception was the direct cause of the following exception:
read_manager_one  | 
read_manager_one  | Traceback (most recent call last):
read_manager_one  |   File "/app/./ServiceProviders/RMWrapper.py", line 110, in <module>
read_manager_one  |     db.create_all() # <--- create db object.
read_manager_one  |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 884, in create_all
read_manager_one  |     self._call_for_binds(bind_key, "create_all")
read_manager_one  |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 865, in _call_for_binds
read_manager_one  |     getattr(metadata, op_name)(bind=engine)
read_manager_one  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/schema.py", line 5581, in create_all
read_manager_one  |     bind._run_ddl_visitor(
read_manager_one  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3225, in _run_ddl_visitor
read_manager_one  |     with self.begin() as conn:
read_manager_one  |   File "/usr/local/lib/python3.9/contextlib.py", line 119, in __enter__
read_manager_one  |     return next(self.gen)
read_manager_one  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3215, in begin
read_manager_one  |     with self.connect() as conn:
read_manager_one  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3251, in connect
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_one        |     return self.pool.connect()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_one        |     return _ConnectionFairy._checkout(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_one        |     fairy = _ConnectionRecord.checkout(pool)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_one        |     rec = pool._do_get()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_one        |     self._dec_overflow()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3215, in begin
broker_three      |     with self.connect() as conn:
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3251, in connect
broker_three      |     return self._connection_cls(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
broker_three      |     Connection._handle_dbapi_exception_noconnection(
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2413, in _handle_dbapi_exception_noconnection
broker_three      |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_three      |     self._dbapi_connection = engine.raw_connection()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_three      |     return self.pool.connect()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_three      |     return _ConnectionFairy._checkout(self)
read_manager_two  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
read_manager_two  |     self._dbapi_connection = engine.raw_connection()
read_manager_two  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
read_manager_two  |     return self.pool.connect()
read_manager_two  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
read_manager_two  |     return _ConnectionFairy._checkout(self)
read_manager_two  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
read_manager_two  |     fairy = _ConnectionRecord.checkout(pool)
read_manager_two  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
read_manager_two  |     rec = pool._do_get()
read_manager_two  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
read_manager_two  |     self._dec_overflow()
read_manager_two  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
read_manager_two  |     raise exc_value.with_traceback(exc_tb)
read_manager_two  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
read_manager_two  |     return self._create_connection()
read_manager_two  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
read_manager_two  |     return _ConnectionRecord(self)
read_manager_two  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_three      |     fairy = _ConnectionRecord.checkout(pool)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_three      |     rec = pool._do_get()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_three      |     self._dec_overflow()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_three      |     raise exc_value.with_traceback(exc_tb)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_three      |     return self._create_connection()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_three      |     return _ConnectionRecord(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_three      |     self.__connect()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_two        |     rec = pool._do_get()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_two        |     self._dec_overflow()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_two        |     raise exc_value.with_traceback(exc_tb)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_two        |     return self._create_connection()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_two        |     return _ConnectionRecord(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_two        |     self.__connect()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_one        |     raise exc_value.with_traceback(exc_tb)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_one        |     return self._create_connection()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_one        |     return _ConnectionRecord(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_one        |     self.__connect()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_one        |     pool.logger.debug("Error on connect(): %s", e)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_one        |     raise exc_value.with_traceback(exc_tb)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_one        |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_one        |     return dialect.connect(*cargs, **cparams)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_one        |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_two        |     pool.logger.debug("Error on connect(): %s", e)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_two        |     raise exc_value.with_traceback(exc_tb)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_two        |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_two        |     return dialect.connect(*cargs, **cparams)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_two        |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_two        |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_two        | psycopg2.OperationalError: connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_two        | 	Is the server running on that host and accepting TCP/IP connections?
broker_two        | 
write_manager     |     rec = pool._do_get()
write_manager     |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
write_manager     |     self._dec_overflow()
write_manager     |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
write_manager     |     raise exc_value.with_traceback(exc_tb)
write_manager     |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
write_manager     |     return self._create_connection()
write_manager     |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
write_manager     |     return _ConnectionRecord(self)
write_manager     |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
write_manager     |     self.__connect()
write_manager     |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
write_manager     |     pool.logger.debug("Error on connect(): %s", e)
write_manager     |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_two        | 
broker_two        | The above exception was the direct cause of the following exception:
broker_two        | 
broker_two        | Traceback (most recent call last):
broker_two        |   File "/app/./Brokers/BrokerWrapper.py", line 148, in <module>
broker_two        |     db.create_all()  # <--- create db object.
broker_two        |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 884, in create_all
broker_two        |     self._call_for_binds(bind_key, "create_all")
broker_two        |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 865, in _call_for_binds
broker_two        |     getattr(metadata, op_name)(bind=engine)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/schema.py", line 5581, in create_all
broker_one        |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_one        | psycopg2.OperationalError: connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_one        | 	Is the server running on that host and accepting TCP/IP connections?
broker_one        | 
broker_one        | 
broker_one        | The above exception was the direct cause of the following exception:
broker_one        | 
broker_one        | Traceback (most recent call last):
broker_one        |   File "/app/./Brokers/BrokerWrapper.py", line 148, in <module>
broker_one        |     db.create_all()  # <--- create db object.
broker_one        |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 884, in create_all
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_three      |     pool.logger.debug("Error on connect(): %s", e)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_three      |     raise exc_value.with_traceback(exc_tb)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_three      |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_three      |     return dialect.connect(*cargs, **cparams)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_three      |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_three      |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_three      | sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "127.0.0.1", port 5432 failed: Connection refused
read_manager_one  |     return self._connection_cls(self)
read_manager_one  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
read_manager_one  |     Connection._handle_dbapi_exception_noconnection(
read_manager_one  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2413, in _handle_dbapi_exception_noconnection
read_manager_one  |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
read_manager_one  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
read_manager_one  |     self._dbapi_connection = engine.raw_connection()
read_manager_one  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
read_manager_one  |     return self.pool.connect()
read_manager_one  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
read_manager_one  |     return _ConnectionFairy._checkout(self)
read_manager_two  |     self.__connect()
read_manager_two  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
read_manager_two  |     pool.logger.debug("Error on connect(): %s", e)
read_manager_two  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
read_manager_two  |     raise exc_value.with_traceback(exc_tb)
read_manager_two  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
read_manager_two  |     self.dbapi_connection = connection = pool._invoke_creator(self)
read_manager_two  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
read_manager_two  |     return dialect.connect(*cargs, **cparams)
read_manager_two  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
read_manager_two  |     return self.loaded_dbapi.connect(*cargs, **cparams)
read_manager_two  |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
read_manager_two  |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
read_manager_two  | sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "127.0.0.1", port 5432 failed: Connection refused
read_manager_one  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
read_manager_one  |     fairy = _ConnectionRecord.checkout(pool)
read_manager_one  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
read_manager_one  |     rec = pool._do_get()
read_manager_one  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
read_manager_one  |     self._dec_overflow()
read_manager_one  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
read_manager_one  |     raise exc_value.with_traceback(exc_tb)
read_manager_one  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
read_manager_one  |     return self._create_connection()
write_manager     |     raise exc_value.with_traceback(exc_tb)
write_manager     |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
write_manager     |     self.dbapi_connection = connection = pool._invoke_creator(self)
write_manager     |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
write_manager     |     return dialect.connect(*cargs, **cparams)
write_manager     |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
write_manager     |     return self.loaded_dbapi.connect(*cargs, **cparams)
write_manager     |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
write_manager     |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
write_manager     | sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "127.0.0.1", port 5432 failed: Connection refused
write_manager     | 	Is the server running on that host and accepting TCP/IP connections?
write_manager     | 
write_manager     | (Background on this error at: https://sqlalche.me/e/20/e3q8)
read_manager_two  | 	Is the server running on that host and accepting TCP/IP connections?
read_manager_two  | 
read_manager_two  | (Background on this error at: https://sqlalche.me/e/20/e3q8)
broker_two        |     bind._run_ddl_visitor(
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3225, in _run_ddl_visitor
broker_two        |     with self.begin() as conn:
broker_two        |   File "/usr/local/lib/python3.9/contextlib.py", line 119, in __enter__
broker_two        |     return next(self.gen)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3215, in begin
broker_two        |     with self.connect() as conn:
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3251, in connect
broker_two        |     return self._connection_cls(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
broker_two        |     Connection._handle_dbapi_exception_noconnection(
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2413, in _handle_dbapi_exception_noconnection
broker_two        |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_two        |     self._dbapi_connection = engine.raw_connection()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_two        |     return self.pool.connect()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_two        |     return _ConnectionFairy._checkout(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_two        |     fairy = _ConnectionRecord.checkout(pool)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_two        |     rec = pool._do_get()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_two        |     self._dec_overflow()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_two        |     raise exc_value.with_traceback(exc_tb)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_two        |     return self._create_connection()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_two        |     return _ConnectionRecord(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_two        |     self.__connect()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_two        |     pool.logger.debug("Error on connect(): %s", e)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_two        |     raise exc_value.with_traceback(exc_tb)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_one        |     self._call_for_binds(bind_key, "create_all")
broker_one        |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 865, in _call_for_binds
broker_one        |     getattr(metadata, op_name)(bind=engine)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/schema.py", line 5581, in create_all
broker_one        |     bind._run_ddl_visitor(
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3225, in _run_ddl_visitor
broker_one        |     with self.begin() as conn:
broker_one        |   File "/usr/local/lib/python3.9/contextlib.py", line 119, in __enter__
broker_one        |     return next(self.gen)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3215, in begin
broker_one        |     with self.connect() as conn:
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3251, in connect
broker_one        |     return self._connection_cls(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
broker_one        |     Connection._handle_dbapi_exception_noconnection(
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2413, in _handle_dbapi_exception_noconnection
broker_one        |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_one        |     self._dbapi_connection = engine.raw_connection()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_one        |     return self.pool.connect()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_one        |     return _ConnectionFairy._checkout(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_one        |     fairy = _ConnectionRecord.checkout(pool)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_one        |     rec = pool._do_get()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_one        |     self._dec_overflow()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_one        |     raise exc_value.with_traceback(exc_tb)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_one        |     return self._create_connection()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_one        |     return _ConnectionRecord(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_one        |     self.__connect()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_one        |     pool.logger.debug("Error on connect(): %s", e)
read_manager_one  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
read_manager_one  |     return _ConnectionRecord(self)
read_manager_one  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
read_manager_one  |     self.__connect()
read_manager_one  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
read_manager_one  |     pool.logger.debug("Error on connect(): %s", e)
read_manager_one  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
read_manager_one  |     raise exc_value.with_traceback(exc_tb)
read_manager_one  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
read_manager_one  |     self.dbapi_connection = connection = pool._invoke_creator(self)
read_manager_one  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
read_manager_one  |     return dialect.connect(*cargs, **cparams)
read_manager_one  |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_three      | 	Is the server running on that host and accepting TCP/IP connections?
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_three      | 
broker_one        |     raise exc_value.with_traceback(exc_tb)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_one        |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_one        |     return dialect.connect(*cargs, **cparams)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_one        |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_one        |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
read_manager_one  |     return self.loaded_dbapi.connect(*cargs, **cparams)
read_manager_one  |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
read_manager_one  |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
read_manager_one  | sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "127.0.0.1", port 5432 failed: Connection refused
read_manager_one  | 	Is the server running on that host and accepting TCP/IP connections?
read_manager_one  | 
read_manager_one  | (Background on this error at: https://sqlalche.me/e/20/e3q8)
broker_two        |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_one        | sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_one        | 	Is the server running on that host and accepting TCP/IP connections?
broker_one        | 
broker_one        | (Background on this error at: https://sqlalche.me/e/20/e3q8)
broker_one        | Traceback (most recent call last):
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_one        |     self._dbapi_connection = engine.raw_connection()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_one        |     return self.pool.connect()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_one        |     return _ConnectionFairy._checkout(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_one        |     fairy = _ConnectionRecord.checkout(pool)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_one        |     rec = pool._do_get()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_one        |     self._dec_overflow()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_one        |     raise exc_value.with_traceback(exc_tb)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_one        |     return self._create_connection()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_one        |     return _ConnectionRecord(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_one        |     self.__connect()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_one        |     pool.logger.debug("Error on connect(): %s", e)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_one        |     raise exc_value.with_traceback(exc_tb)
broker_two        |     return dialect.connect(*cargs, **cparams)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_two        |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_two        |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_two        | sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_two        | 	Is the server running on that host and accepting TCP/IP connections?
broker_two        | 
broker_two        | (Background on this error at: https://sqlalche.me/e/20/e3q8)
broker_two        | Traceback (most recent call last):
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_two        |     self._dbapi_connection = engine.raw_connection()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_two        |     return self.pool.connect()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_two        |     return _ConnectionFairy._checkout(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_two        |     fairy = _ConnectionRecord.checkout(pool)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_two        |     rec = pool._do_get()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_two        |     self._dec_overflow()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_two        |     raise exc_value.with_traceback(exc_tb)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_two        |     return self._create_connection()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_two        |     return _ConnectionRecord(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_two        |     self.__connect()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_two        |     pool.logger.debug("Error on connect(): %s", e)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_two        |     raise exc_value.with_traceback(exc_tb)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_two        |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_two        |     return dialect.connect(*cargs, **cparams)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_two        |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_two        |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_one        |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_one        |     return dialect.connect(*cargs, **cparams)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_one        |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_one        |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_one        | psycopg2.OperationalError: connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_one        | 	Is the server running on that host and accepting TCP/IP connections?
broker_one        | 
broker_two        | psycopg2.OperationalError: connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_two        | 	Is the server running on that host and accepting TCP/IP connections?
broker_two        | 
broker_two        | 
broker_two        | The above exception was the direct cause of the following exception:
broker_two        | 
broker_two        | Traceback (most recent call last):
broker_two        |   File "/app/./Brokers/BrokerWrapper.py", line 148, in <module>
broker_two        |     db.create_all()  # <--- create db object.
broker_one        | 
broker_one        | The above exception was the direct cause of the following exception:
broker_one        | 
broker_one        | Traceback (most recent call last):
broker_one        |   File "/app/./Brokers/BrokerWrapper.py", line 148, in <module>
broker_one        |     db.create_all()  # <--- create db object.
broker_one        |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 884, in create_all
broker_one        |     self._call_for_binds(bind_key, "create_all")
broker_one        |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 865, in _call_for_binds
broker_one        |     getattr(metadata, op_name)(bind=engine)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/schema.py", line 5581, in create_all
broker_one        |     bind._run_ddl_visitor(
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3225, in _run_ddl_visitor
broker_two        |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 884, in create_all
broker_two        |     self._call_for_binds(bind_key, "create_all")
broker_two        |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 865, in _call_for_binds
broker_two        |     getattr(metadata, op_name)(bind=engine)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/schema.py", line 5581, in create_all
broker_two        |     bind._run_ddl_visitor(
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3225, in _run_ddl_visitor
broker_two        |     with self.begin() as conn:
broker_two        |   File "/usr/local/lib/python3.9/contextlib.py", line 119, in __enter__
broker_two        |     return next(self.gen)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3215, in begin
broker_two        |     with self.connect() as conn:
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3251, in connect
broker_two        |     return self._connection_cls(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
broker_two        |     Connection._handle_dbapi_exception_noconnection(
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2413, in _handle_dbapi_exception_noconnection
broker_two        |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_two        |     self._dbapi_connection = engine.raw_connection()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_two        |     return self.pool.connect()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_two        |     return _ConnectionFairy._checkout(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_two        |     fairy = _ConnectionRecord.checkout(pool)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_two        |     rec = pool._do_get()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_two        |     self._dec_overflow()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_one        |     with self.begin() as conn:
broker_one        |   File "/usr/local/lib/python3.9/contextlib.py", line 119, in __enter__
broker_one        |     return next(self.gen)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3215, in begin
broker_one        |     with self.connect() as conn:
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3251, in connect
broker_one        |     return self._connection_cls(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
broker_one        |     Connection._handle_dbapi_exception_noconnection(
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2413, in _handle_dbapi_exception_noconnection
broker_two        |     raise exc_value.with_traceback(exc_tb)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_two        |     return self._create_connection()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_one        |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
broker_two        |     return _ConnectionRecord(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_two        |     self.__connect()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_two        |     pool.logger.debug("Error on connect(): %s", e)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_two        |     raise exc_value.with_traceback(exc_tb)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_two        |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_two        |     return dialect.connect(*cargs, **cparams)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_two        |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_two        |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_two        | sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_two        | 	Is the server running on that host and accepting TCP/IP connections?
broker_two        | 
broker_two        | (Background on this error at: https://sqlalche.me/e/20/e3q8)
broker_three      | (Background on this error at: https://sqlalche.me/e/20/e3q8)
broker_three      | Traceback (most recent call last):
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_three      |     self._dbapi_connection = engine.raw_connection()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_three      |     return self.pool.connect()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_three      |     return _ConnectionFairy._checkout(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_three      |     fairy = _ConnectionRecord.checkout(pool)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_two        | Traceback (most recent call last):
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_two        |     self._dbapi_connection = engine.raw_connection()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_two        |     return self.pool.connect()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_two        |     return _ConnectionFairy._checkout(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_two        |     fairy = _ConnectionRecord.checkout(pool)
broker_three      |     rec = pool._do_get()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_three      |     self._dec_overflow()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_three      |     raise exc_value.with_traceback(exc_tb)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_three      |     return self._create_connection()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_three      |     return _ConnectionRecord(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_three      |     self.__connect()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_three      |     pool.logger.debug("Error on connect(): %s", e)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_three      |     raise exc_value.with_traceback(exc_tb)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_three      |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_three      |     return dialect.connect(*cargs, **cparams)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_three      |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_three      |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_three      | psycopg2.OperationalError: connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_three      | 	Is the server running on that host and accepting TCP/IP connections?
broker_three      | 
broker_three      | 
broker_three      | The above exception was the direct cause of the following exception:
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_two        |     rec = pool._do_get()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_two        |     self._dec_overflow()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_two        |     raise exc_value.with_traceback(exc_tb)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_two        |     return self._create_connection()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_two        |     return _ConnectionRecord(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_two        |     self.__connect()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_two        |     pool.logger.debug("Error on connect(): %s", e)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_two        |     raise exc_value.with_traceback(exc_tb)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_two        |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_two        |     return dialect.connect(*cargs, **cparams)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_three      | 
broker_three      | Traceback (most recent call last):
broker_three      |   File "/app/./Brokers/BrokerWrapper.py", line 148, in <module>
broker_three      |     db.create_all()  # <--- create db object.
broker_three      |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 884, in create_all
broker_three      |     self._call_for_binds(bind_key, "create_all")
broker_three      |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 865, in _call_for_binds
broker_three      |     getattr(metadata, op_name)(bind=engine)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/schema.py", line 5581, in create_all
broker_three      |     bind._run_ddl_visitor(
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3225, in _run_ddl_visitor
broker_three      |     with self.begin() as conn:
broker_three      |   File "/usr/local/lib/python3.9/contextlib.py", line 119, in __enter__
broker_three      |     return next(self.gen)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3215, in begin
broker_three      |     with self.connect() as conn:
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3251, in connect
broker_three      |     return self._connection_cls(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
broker_three      |     Connection._handle_dbapi_exception_noconnection(
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2413, in _handle_dbapi_exception_noconnection
broker_three      |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_three      |     self._dbapi_connection = engine.raw_connection()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_three      |     return self.pool.connect()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_three      |     return _ConnectionFairy._checkout(self)
broker_two        |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_two        |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_two        | psycopg2.OperationalError: connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_two        | 	Is the server running on that host and accepting TCP/IP connections?
broker_two        | 
broker_two        | 
broker_two        | The above exception was the direct cause of the following exception:
broker_two        | 
broker_two        | Traceback (most recent call last):
broker_two        |   File "/app/./Brokers/BrokerWrapper.py", line 148, in <module>
broker_two        |     db.create_all()  # <--- create db object.
broker_two        |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 884, in create_all
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_three      |     fairy = _ConnectionRecord.checkout(pool)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_three      |     rec = pool._do_get()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_three      |     self._dec_overflow()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_three      |     raise exc_value.with_traceback(exc_tb)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_three      |     return self._create_connection()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_three      |     return _ConnectionRecord(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_three      |     self.__connect()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_three      |     pool.logger.debug("Error on connect(): %s", e)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_three      |     raise exc_value.with_traceback(exc_tb)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_three      |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_three      |     return dialect.connect(*cargs, **cparams)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_three      |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_three      |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_three      | sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_three      | 	Is the server running on that host and accepting TCP/IP connections?
broker_three      | 
broker_two        |     self._call_for_binds(bind_key, "create_all")
broker_two        |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 865, in _call_for_binds
broker_two        |     getattr(metadata, op_name)(bind=engine)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/schema.py", line 5581, in create_all
broker_two        |     bind._run_ddl_visitor(
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3225, in _run_ddl_visitor
broker_two        |     with self.begin() as conn:
broker_two        |   File "/usr/local/lib/python3.9/contextlib.py", line 119, in __enter__
broker_two        |     return next(self.gen)
broker_three      | (Background on this error at: https://sqlalche.me/e/20/e3q8)
broker_three      | Traceback (most recent call last):
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_three      |     self._dbapi_connection = engine.raw_connection()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_three      |     return self.pool.connect()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_three      |     return _ConnectionFairy._checkout(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_three      |     fairy = _ConnectionRecord.checkout(pool)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_three      |     rec = pool._do_get()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_three      |     self._dec_overflow()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_three      |     raise exc_value.with_traceback(exc_tb)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_three      |     return self._create_connection()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_three      |     return _ConnectionRecord(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_three      |     self.__connect()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_three      |     pool.logger.debug("Error on connect(): %s", e)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_three      |     raise exc_value.with_traceback(exc_tb)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_three      |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_three      |     return dialect.connect(*cargs, **cparams)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_three      |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_three      |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_three      | psycopg2.OperationalError: connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_three      | 	Is the server running on that host and accepting TCP/IP connections?
broker_three      | 
broker_three      | 
broker_three      | The above exception was the direct cause of the following exception:
broker_three      | 
broker_three      | Traceback (most recent call last):
broker_three      |   File "/app/./Brokers/BrokerWrapper.py", line 148, in <module>
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3215, in begin
broker_two        |     with self.connect() as conn:
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3251, in connect
broker_two        |     return self._connection_cls(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
broker_two        |     Connection._handle_dbapi_exception_noconnection(
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2413, in _handle_dbapi_exception_noconnection
broker_two        |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_two        |     self._dbapi_connection = engine.raw_connection()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_two        |     return self.pool.connect()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_two        |     return _ConnectionFairy._checkout(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_two        |     fairy = _ConnectionRecord.checkout(pool)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_two        |     rec = pool._do_get()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_two        |     self._dec_overflow()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_two        |     raise exc_value.with_traceback(exc_tb)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_two        |     return self._create_connection()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_two        |     return _ConnectionRecord(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_two        |     self.__connect()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_two        |     pool.logger.debug("Error on connect(): %s", e)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_one        |     self._dbapi_connection = engine.raw_connection()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_one        |     return self.pool.connect()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_one        |     return _ConnectionFairy._checkout(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_one        |     fairy = _ConnectionRecord.checkout(pool)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_one        |     rec = pool._do_get()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_one        |     self._dec_overflow()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_one        |     raise exc_value.with_traceback(exc_tb)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_one        |     return self._create_connection()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_one        |     return _ConnectionRecord(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_one        |     self.__connect()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_two        |     raise exc_value.with_traceback(exc_tb)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_two        |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_two        |     return dialect.connect(*cargs, **cparams)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_two        |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_two        |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_two        | sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_two        | 	Is the server running on that host and accepting TCP/IP connections?
broker_two        | 
broker_two        | (Background on this error at: https://sqlalche.me/e/20/e3q8)
broker_two        | Traceback (most recent call last):
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_two        |     self._dbapi_connection = engine.raw_connection()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_two        |     return self.pool.connect()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_two        |     return _ConnectionFairy._checkout(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_two        |     fairy = _ConnectionRecord.checkout(pool)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_two        |     rec = pool._do_get()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_two        |     self._dec_overflow()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_two        |     raise exc_value.with_traceback(exc_tb)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_two        |     return self._create_connection()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_two        |     return _ConnectionRecord(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_two        |     self.__connect()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_two        |     pool.logger.debug("Error on connect(): %s", e)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_two        |     raise exc_value.with_traceback(exc_tb)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_two        |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_two        |     return dialect.connect(*cargs, **cparams)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_two        |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_two        |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_two        | psycopg2.OperationalError: connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_one        |     pool.logger.debug("Error on connect(): %s", e)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_one        |     raise exc_value.with_traceback(exc_tb)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_one        |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_one        |     return dialect.connect(*cargs, **cparams)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_three      |     db.create_all()  # <--- create db object.
broker_three      |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 884, in create_all
broker_three      |     self._call_for_binds(bind_key, "create_all")
broker_three      |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 865, in _call_for_binds
broker_three      |     getattr(metadata, op_name)(bind=engine)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/schema.py", line 5581, in create_all
broker_three      |     bind._run_ddl_visitor(
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3225, in _run_ddl_visitor
broker_three      |     with self.begin() as conn:
broker_three      |   File "/usr/local/lib/python3.9/contextlib.py", line 119, in __enter__
broker_three      |     return next(self.gen)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3215, in begin
broker_three      |     with self.connect() as conn:
broker_one        |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_one        |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_one        | sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_one        | 	Is the server running on that host and accepting TCP/IP connections?
broker_one        | 
broker_one        | (Background on this error at: https://sqlalche.me/e/20/e3q8)
broker_one        | Traceback (most recent call last):
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_one        |     self._dbapi_connection = engine.raw_connection()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3251, in connect
broker_three      |     return self._connection_cls(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
broker_three      |     Connection._handle_dbapi_exception_noconnection(
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2413, in _handle_dbapi_exception_noconnection
broker_three      |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_three      |     self._dbapi_connection = engine.raw_connection()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_three      |     return self.pool.connect()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_three      |     return _ConnectionFairy._checkout(self)
broker_two        | 	Is the server running on that host and accepting TCP/IP connections?
broker_two        | 
broker_two        | 
broker_two        | The above exception was the direct cause of the following exception:
broker_two        | 
broker_two        | Traceback (most recent call last):
broker_two        |   File "/app/./Brokers/BrokerWrapper.py", line 148, in <module>
broker_two        |     db.create_all()  # <--- create db object.
broker_two        |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 884, in create_all
broker_two        |     self._call_for_binds(bind_key, "create_all")
broker_two        |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 865, in _call_for_binds
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_three      |     fairy = _ConnectionRecord.checkout(pool)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_three      |     rec = pool._do_get()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_three      |     self._dec_overflow()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_one        |     return self.pool.connect()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_three      |     raise exc_value.with_traceback(exc_tb)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_one        |     return _ConnectionFairy._checkout(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_one        |     fairy = _ConnectionRecord.checkout(pool)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_one        |     rec = pool._do_get()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_one        |     self._dec_overflow()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_one        |     raise exc_value.with_traceback(exc_tb)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_one        |     return self._create_connection()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_three      |     return self._create_connection()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_three      |     return _ConnectionRecord(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_three      |     self.__connect()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_three      |     pool.logger.debug("Error on connect(): %s", e)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_three      |     raise exc_value.with_traceback(exc_tb)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_three      |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_two        |     getattr(metadata, op_name)(bind=engine)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/schema.py", line 5581, in create_all
broker_two        |     bind._run_ddl_visitor(
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3225, in _run_ddl_visitor
broker_two        |     with self.begin() as conn:
broker_two        |   File "/usr/local/lib/python3.9/contextlib.py", line 119, in __enter__
broker_two        |     return next(self.gen)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3215, in begin
broker_two        |     with self.connect() as conn:
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3251, in connect
broker_one        |     return _ConnectionRecord(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_one        |     self.__connect()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_one        |     pool.logger.debug("Error on connect(): %s", e)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_one        |     raise exc_value.with_traceback(exc_tb)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_one        |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_one        |     return dialect.connect(*cargs, **cparams)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_three      |     return dialect.connect(*cargs, **cparams)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_three      |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_three      |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_three      | sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_two        |     return self._connection_cls(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
broker_two        |     Connection._handle_dbapi_exception_noconnection(
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2413, in _handle_dbapi_exception_noconnection
broker_two        |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_two        |     self._dbapi_connection = engine.raw_connection()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_two        |     return self.pool.connect()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_two        |     return _ConnectionFairy._checkout(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_two        |     fairy = _ConnectionRecord.checkout(pool)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_two        |     rec = pool._do_get()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_two        |     self._dec_overflow()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_two        |     raise exc_value.with_traceback(exc_tb)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_two        |     return self._create_connection()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_two        |     return _ConnectionRecord(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_one        |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_two        |     self.__connect()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_two        |     pool.logger.debug("Error on connect(): %s", e)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_two        |     raise exc_value.with_traceback(exc_tb)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_two        |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_one        |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_one        |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_one        | psycopg2.OperationalError: connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_one        | 	Is the server running on that host and accepting TCP/IP connections?
broker_one        | 
broker_one        | 
broker_one        | The above exception was the direct cause of the following exception:
broker_one        | 
broker_one        | Traceback (most recent call last):
broker_one        |   File "/app/./Brokers/BrokerWrapper.py", line 148, in <module>
broker_one        |     db.create_all()  # <--- create db object.
broker_one        |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 884, in create_all
broker_one        |     self._call_for_binds(bind_key, "create_all")
broker_two        |     return dialect.connect(*cargs, **cparams)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_two        |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_two        |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_two        | sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_two        | 	Is the server running on that host and accepting TCP/IP connections?
broker_two        | 
broker_two        | (Background on this error at: https://sqlalche.me/e/20/e3q8)
broker_two        | Traceback (most recent call last):
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_one        |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 865, in _call_for_binds
broker_one        |     getattr(metadata, op_name)(bind=engine)
broker_two        |     self._dbapi_connection = engine.raw_connection()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_two        |     return self.pool.connect()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_two        |     return _ConnectionFairy._checkout(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_two        |     fairy = _ConnectionRecord.checkout(pool)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_two        |     rec = pool._do_get()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_two        |     self._dec_overflow()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_two        |     raise exc_value.with_traceback(exc_tb)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_two        |     return self._create_connection()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_two        |     return _ConnectionRecord(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_two        |     self.__connect()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_three      | 	Is the server running on that host and accepting TCP/IP connections?
broker_three      | 
broker_three      | (Background on this error at: https://sqlalche.me/e/20/e3q8)
broker_three      | Traceback (most recent call last):
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_three      |     self._dbapi_connection = engine.raw_connection()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_three      |     return self.pool.connect()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_three      |     return _ConnectionFairy._checkout(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_three      |     fairy = _ConnectionRecord.checkout(pool)
broker_two        |     pool.logger.debug("Error on connect(): %s", e)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_two        |     raise exc_value.with_traceback(exc_tb)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_two        |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_two        |     return dialect.connect(*cargs, **cparams)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_two        |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_two        |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_two        | psycopg2.OperationalError: connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_two        | 	Is the server running on that host and accepting TCP/IP connections?
broker_two        | 
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_three      |     rec = pool._do_get()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_three      |     self._dec_overflow()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_three      |     raise exc_value.with_traceback(exc_tb)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_three      |     return self._create_connection()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_three      |     return _ConnectionRecord(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_three      |     self.__connect()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_three      |     pool.logger.debug("Error on connect(): %s", e)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_three      |     raise exc_value.with_traceback(exc_tb)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_three      |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_three      |     return dialect.connect(*cargs, **cparams)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_three      |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_three      |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_three      | psycopg2.OperationalError: connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_three      | 	Is the server running on that host and accepting TCP/IP connections?
broker_three      | 
broker_three      | 
broker_three      | The above exception was the direct cause of the following exception:
broker_three      | 
broker_two        | 
broker_two        | The above exception was the direct cause of the following exception:
broker_two        | 
broker_two        | Traceback (most recent call last):
broker_two        |   File "/app/./Brokers/BrokerWrapper.py", line 148, in <module>
broker_two        |     db.create_all()  # <--- create db object.
broker_two        |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 884, in create_all
broker_two        |     self._call_for_binds(bind_key, "create_all")
broker_two        |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 865, in _call_for_binds
broker_two        |     getattr(metadata, op_name)(bind=engine)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/schema.py", line 5581, in create_all
broker_two        |     bind._run_ddl_visitor(
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3225, in _run_ddl_visitor
broker_two        |     with self.begin() as conn:
broker_two        |   File "/usr/local/lib/python3.9/contextlib.py", line 119, in __enter__
broker_three      | Traceback (most recent call last):
broker_three      |   File "/app/./Brokers/BrokerWrapper.py", line 148, in <module>
broker_three      |     db.create_all()  # <--- create db object.
broker_three      |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 884, in create_all
broker_three      |     self._call_for_binds(bind_key, "create_all")
broker_three      |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 865, in _call_for_binds
broker_three      |     getattr(metadata, op_name)(bind=engine)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/schema.py", line 5581, in create_all
broker_three      |     bind._run_ddl_visitor(
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3225, in _run_ddl_visitor
broker_three      |     with self.begin() as conn:
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/schema.py", line 5581, in create_all
broker_one        |     bind._run_ddl_visitor(
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3225, in _run_ddl_visitor
broker_one        |     with self.begin() as conn:
broker_one        |   File "/usr/local/lib/python3.9/contextlib.py", line 119, in __enter__
broker_one        |     return next(self.gen)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3215, in begin
broker_one        |     with self.connect() as conn:
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3251, in connect
broker_one        |     return self._connection_cls(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
broker_one        |     Connection._handle_dbapi_exception_noconnection(
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2413, in _handle_dbapi_exception_noconnection
broker_two        |     return next(self.gen)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3215, in begin
broker_two        |     with self.connect() as conn:
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3251, in connect
broker_two        |     return self._connection_cls(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
broker_two        |     Connection._handle_dbapi_exception_noconnection(
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2413, in _handle_dbapi_exception_noconnection
broker_two        |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_two        |     self._dbapi_connection = engine.raw_connection()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_two        |     return self.pool.connect()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_two        |     return _ConnectionFairy._checkout(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_two        |     fairy = _ConnectionRecord.checkout(pool)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_two        |     rec = pool._do_get()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_two        |     self._dec_overflow()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_one        |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
broker_three      |   File "/usr/local/lib/python3.9/contextlib.py", line 119, in __enter__
broker_three      |     return next(self.gen)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_one        |     self._dbapi_connection = engine.raw_connection()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_one        |     return self.pool.connect()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_one        |     return _ConnectionFairy._checkout(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_one        |     fairy = _ConnectionRecord.checkout(pool)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_one        |     rec = pool._do_get()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_one        |     self._dec_overflow()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_one        |     raise exc_value.with_traceback(exc_tb)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_two        |     raise exc_value.with_traceback(exc_tb)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_two        |     return self._create_connection()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_two        |     return _ConnectionRecord(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_two        |     self.__connect()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_two        |     pool.logger.debug("Error on connect(): %s", e)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_two        |     raise exc_value.with_traceback(exc_tb)
broker_one        |     return self._create_connection()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_one        |     return _ConnectionRecord(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_one        |     self.__connect()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_one        |     pool.logger.debug("Error on connect(): %s", e)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_one        |     raise exc_value.with_traceback(exc_tb)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_one        |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_one        |     return dialect.connect(*cargs, **cparams)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_one        |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_one        |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_one        | sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_one        | 	Is the server running on that host and accepting TCP/IP connections?
broker_one        | 
broker_one        | (Background on this error at: https://sqlalche.me/e/20/e3q8)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_two        |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_one        | Traceback (most recent call last):
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_one        |     self._dbapi_connection = engine.raw_connection()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_one        |     return self.pool.connect()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_one        |     return _ConnectionFairy._checkout(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3215, in begin
broker_three      |     with self.connect() as conn:
broker_one        |     fairy = _ConnectionRecord.checkout(pool)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_one        |     rec = pool._do_get()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_one        |     self._dec_overflow()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_one        |     raise exc_value.with_traceback(exc_tb)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_one        |     return self._create_connection()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_one        |     return _ConnectionRecord(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_one        |     self.__connect()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_two        |     return dialect.connect(*cargs, **cparams)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_two        |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_two        |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_two        | sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_two        | 	Is the server running on that host and accepting TCP/IP connections?
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3251, in connect
broker_three      |     return self._connection_cls(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
broker_two        | 
broker_two        | (Background on this error at: https://sqlalche.me/e/20/e3q8)
broker_two        | Traceback (most recent call last):
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_two        |     self._dbapi_connection = engine.raw_connection()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_two        |     return self.pool.connect()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_one        |     pool.logger.debug("Error on connect(): %s", e)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_one        |     raise exc_value.with_traceback(exc_tb)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_one        |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_one        |     return dialect.connect(*cargs, **cparams)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_two        |     return _ConnectionFairy._checkout(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_two        |     fairy = _ConnectionRecord.checkout(pool)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_two        |     rec = pool._do_get()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_two        |     self._dec_overflow()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_two        |     raise exc_value.with_traceback(exc_tb)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_two        |     return self._create_connection()
broker_three      |     Connection._handle_dbapi_exception_noconnection(
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2413, in _handle_dbapi_exception_noconnection
broker_three      |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_three      |     self._dbapi_connection = engine.raw_connection()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_three      |     return self.pool.connect()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_three      |     return _ConnectionFairy._checkout(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_three      |     fairy = _ConnectionRecord.checkout(pool)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_two        |     return _ConnectionRecord(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_two        |     self.__connect()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_two        |     pool.logger.debug("Error on connect(): %s", e)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_two        |     raise exc_value.with_traceback(exc_tb)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_three      |     rec = pool._do_get()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_three      |     self._dec_overflow()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_three      |     raise exc_value.with_traceback(exc_tb)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_three      |     return self._create_connection()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_three      |     return _ConnectionRecord(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_three      |     self.__connect()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_three      |     pool.logger.debug("Error on connect(): %s", e)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_three      |     raise exc_value.with_traceback(exc_tb)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_one        |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_one        |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_one        | psycopg2.OperationalError: connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_one        | 	Is the server running on that host and accepting TCP/IP connections?
broker_one        | 
broker_one        | 
broker_one        | The above exception was the direct cause of the following exception:
broker_one        | 
broker_three      |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_three      |     return dialect.connect(*cargs, **cparams)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_three      |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_three      |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_three      | sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_three      | 	Is the server running on that host and accepting TCP/IP connections?
broker_three      | 
broker_three      | (Background on this error at: https://sqlalche.me/e/20/e3q8)
broker_three      | Traceback (most recent call last):
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_two        |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_two        |     return dialect.connect(*cargs, **cparams)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_two        |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_two        |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_two        | psycopg2.OperationalError: connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_two        | 	Is the server running on that host and accepting TCP/IP connections?
broker_two        | 
broker_two        | 
broker_two        | The above exception was the direct cause of the following exception:
broker_two        | 
broker_two        | Traceback (most recent call last):
broker_two        |   File "/app/./Brokers/BrokerWrapper.py", line 148, in <module>
broker_two        |     db.create_all()  # <--- create db object.
broker_two        |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 884, in create_all
broker_two        |     self._call_for_binds(bind_key, "create_all")
broker_two        |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 865, in _call_for_binds
broker_two        |     getattr(metadata, op_name)(bind=engine)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_three      |     self._dbapi_connection = engine.raw_connection()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_three      |     return self.pool.connect()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_three      |     return _ConnectionFairy._checkout(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_three      |     fairy = _ConnectionRecord.checkout(pool)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_three      |     rec = pool._do_get()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_three      |     self._dec_overflow()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_three      |     raise exc_value.with_traceback(exc_tb)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_three      |     return self._create_connection()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_three      |     return _ConnectionRecord(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_three      |     self.__connect()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_three      |     pool.logger.debug("Error on connect(): %s", e)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_three      |     raise exc_value.with_traceback(exc_tb)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_three      |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_one        | Traceback (most recent call last):
broker_one        |   File "/app/./Brokers/BrokerWrapper.py", line 148, in <module>
broker_one        |     db.create_all()  # <--- create db object.
broker_one        |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 884, in create_all
broker_one        |     self._call_for_binds(bind_key, "create_all")
broker_one        |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 865, in _call_for_binds
broker_one        |     getattr(metadata, op_name)(bind=engine)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/schema.py", line 5581, in create_all
broker_one        |     bind._run_ddl_visitor(
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3225, in _run_ddl_visitor
broker_one        |     with self.begin() as conn:
broker_one        |   File "/usr/local/lib/python3.9/contextlib.py", line 119, in __enter__
broker_one        |     return next(self.gen)
broker_three      |     return dialect.connect(*cargs, **cparams)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_three      |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_three      |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_three      | psycopg2.OperationalError: connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_three      | 	Is the server running on that host and accepting TCP/IP connections?
broker_three      | 
broker_three      | 
broker_three      | The above exception was the direct cause of the following exception:
broker_three      | 
broker_three      | Traceback (most recent call last):
broker_three      |   File "/app/./Brokers/BrokerWrapper.py", line 148, in <module>
broker_three      |     db.create_all()  # <--- create db object.
broker_three      |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 884, in create_all
broker_three      |     self._call_for_binds(bind_key, "create_all")
broker_three      |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 865, in _call_for_binds
broker_three      |     getattr(metadata, op_name)(bind=engine)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/schema.py", line 5581, in create_all
broker_three      |     bind._run_ddl_visitor(
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3225, in _run_ddl_visitor
broker_three      |     with self.begin() as conn:
broker_three      |   File "/usr/local/lib/python3.9/contextlib.py", line 119, in __enter__
broker_three      |     return next(self.gen)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3215, in begin
broker_three      |     with self.connect() as conn:
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3251, in connect
broker_three      |     return self._connection_cls(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
broker_three      |     Connection._handle_dbapi_exception_noconnection(
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2413, in _handle_dbapi_exception_noconnection
broker_three      |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_three      |     self._dbapi_connection = engine.raw_connection()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_three      |     return self.pool.connect()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3215, in begin
broker_one        |     with self.connect() as conn:
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3251, in connect
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/schema.py", line 5581, in create_all
broker_two        |     bind._run_ddl_visitor(
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3225, in _run_ddl_visitor
broker_two        |     with self.begin() as conn:
broker_two        |   File "/usr/local/lib/python3.9/contextlib.py", line 119, in __enter__
broker_two        |     return next(self.gen)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3215, in begin
broker_two        |     with self.connect() as conn:
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3251, in connect
broker_two        |     return self._connection_cls(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
broker_two        |     Connection._handle_dbapi_exception_noconnection(
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2413, in _handle_dbapi_exception_noconnection
broker_two        |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_two        |     self._dbapi_connection = engine.raw_connection()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_two        |     return self.pool.connect()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_two        |     return _ConnectionFairy._checkout(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_two        |     fairy = _ConnectionRecord.checkout(pool)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_two        |     rec = pool._do_get()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_two        |     self._dec_overflow()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_three      |     return _ConnectionFairy._checkout(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_three      |     fairy = _ConnectionRecord.checkout(pool)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_three      |     rec = pool._do_get()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_three      |     self._dec_overflow()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_three      |     raise exc_value.with_traceback(exc_tb)
broker_two        |     raise exc_value.with_traceback(exc_tb)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_two        |     return self._create_connection()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_two        |     return _ConnectionRecord(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_two        |     self.__connect()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_two        |     pool.logger.debug("Error on connect(): %s", e)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_one        |     return self._connection_cls(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
broker_one        |     Connection._handle_dbapi_exception_noconnection(
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2413, in _handle_dbapi_exception_noconnection
broker_two        |     raise exc_value.with_traceback(exc_tb)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_two        |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_two        |     return dialect.connect(*cargs, **cparams)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_two        |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_two        |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_three      |     return self._create_connection()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_three      |     return _ConnectionRecord(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_three      |     self.__connect()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_three      |     pool.logger.debug("Error on connect(): %s", e)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_three      |     raise exc_value.with_traceback(exc_tb)
broker_one        |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_one        |     self._dbapi_connection = engine.raw_connection()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_one        |     return self.pool.connect()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_one        |     return _ConnectionFairy._checkout(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_one        |     fairy = _ConnectionRecord.checkout(pool)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_one        |     rec = pool._do_get()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_one        |     self._dec_overflow()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_one        |     raise exc_value.with_traceback(exc_tb)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_one        |     return self._create_connection()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_three      |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_three      |     return dialect.connect(*cargs, **cparams)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_three      |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_three      |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_three      | sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_three      | 	Is the server running on that host and accepting TCP/IP connections?
broker_three      | 
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_one        |     return _ConnectionRecord(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_one        |     self.__connect()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_one        |     pool.logger.debug("Error on connect(): %s", e)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_three      | (Background on this error at: https://sqlalche.me/e/20/e3q8)
broker_three      | Traceback (most recent call last):
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_three      |     self._dbapi_connection = engine.raw_connection()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_three      |     return self.pool.connect()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_two        | sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_two        | 	Is the server running on that host and accepting TCP/IP connections?
broker_two        | 
broker_two        | (Background on this error at: https://sqlalche.me/e/20/e3q8)
broker_one        |     raise exc_value.with_traceback(exc_tb)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_one        |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_one        |     return dialect.connect(*cargs, **cparams)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_one        |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_one        |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_one        | sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_one        | 	Is the server running on that host and accepting TCP/IP connections?
broker_one        | 
broker_one        | (Background on this error at: https://sqlalche.me/e/20/e3q8)
broker_one        | Traceback (most recent call last):
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_one        |     self._dbapi_connection = engine.raw_connection()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_one        |     return self.pool.connect()
broker_three      |     return _ConnectionFairy._checkout(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_three      |     fairy = _ConnectionRecord.checkout(pool)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_three      |     rec = pool._do_get()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_three      |     self._dec_overflow()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_three      |     raise exc_value.with_traceback(exc_tb)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_three      |     return self._create_connection()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_three      |     return _ConnectionRecord(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_one        |     return _ConnectionFairy._checkout(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_one        |     fairy = _ConnectionRecord.checkout(pool)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_one        |     rec = pool._do_get()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_one        |     self._dec_overflow()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_one        |     raise exc_value.with_traceback(exc_tb)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_one        |     return self._create_connection()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_one        |     return _ConnectionRecord(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_one        |     self.__connect()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_one        |     pool.logger.debug("Error on connect(): %s", e)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_one        |     raise exc_value.with_traceback(exc_tb)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_one        |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_one        |     return dialect.connect(*cargs, **cparams)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_one        |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_three      |     self.__connect()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_three      |     pool.logger.debug("Error on connect(): %s", e)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_three      |     raise exc_value.with_traceback(exc_tb)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_three      |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_three      |     return dialect.connect(*cargs, **cparams)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_three      |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_three      |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_three      | psycopg2.OperationalError: connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_three      | 	Is the server running on that host and accepting TCP/IP connections?
broker_three      | 
broker_three      | 
broker_three      | The above exception was the direct cause of the following exception:
broker_three      | 
broker_three      | Traceback (most recent call last):
broker_three      |   File "/app/./Brokers/BrokerWrapper.py", line 148, in <module>
broker_three      |     db.create_all()  # <--- create db object.
broker_three      |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 884, in create_all
broker_three      |     self._call_for_binds(bind_key, "create_all")
broker_three      |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 865, in _call_for_binds
broker_three      |     getattr(metadata, op_name)(bind=engine)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/schema.py", line 5581, in create_all
broker_one        |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_one        |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_one        | psycopg2.OperationalError: connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_one        | 	Is the server running on that host and accepting TCP/IP connections?
broker_one        | 
broker_one        | 
broker_one        | The above exception was the direct cause of the following exception:
broker_one        | 
broker_one        | Traceback (most recent call last):
broker_one        |   File "/app/./Brokers/BrokerWrapper.py", line 148, in <module>
broker_one        |     db.create_all()  # <--- create db object.
broker_one        |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 884, in create_all
broker_three      |     bind._run_ddl_visitor(
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3225, in _run_ddl_visitor
broker_three      |     with self.begin() as conn:
broker_three      |   File "/usr/local/lib/python3.9/contextlib.py", line 119, in __enter__
broker_three      |     return next(self.gen)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3215, in begin
broker_three      |     with self.connect() as conn:
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3251, in connect
broker_three      |     return self._connection_cls(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
broker_three      |     Connection._handle_dbapi_exception_noconnection(
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2413, in _handle_dbapi_exception_noconnection
broker_three      |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_three      |     self._dbapi_connection = engine.raw_connection()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_three      |     return self.pool.connect()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_three      |     return _ConnectionFairy._checkout(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_one        |     self._call_for_binds(bind_key, "create_all")
broker_one        |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 865, in _call_for_binds
broker_one        |     getattr(metadata, op_name)(bind=engine)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/schema.py", line 5581, in create_all
broker_one        |     bind._run_ddl_visitor(
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3225, in _run_ddl_visitor
broker_one        |     with self.begin() as conn:
broker_one        |   File "/usr/local/lib/python3.9/contextlib.py", line 119, in __enter__
broker_one        |     return next(self.gen)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3215, in begin
broker_one        |     with self.connect() as conn:
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3251, in connect
broker_one        |     return self._connection_cls(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
broker_one        |     Connection._handle_dbapi_exception_noconnection(
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2413, in _handle_dbapi_exception_noconnection
broker_one        |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_one        |     self._dbapi_connection = engine.raw_connection()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_one        |     return self.pool.connect()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_one        |     return _ConnectionFairy._checkout(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_three      |     fairy = _ConnectionRecord.checkout(pool)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_three      |     rec = pool._do_get()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_three      |     self._dec_overflow()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_three      |     raise exc_value.with_traceback(exc_tb)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_three      |     return self._create_connection()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_three      |     return _ConnectionRecord(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_three      |     self.__connect()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_three      |     pool.logger.debug("Error on connect(): %s", e)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_three      |     raise exc_value.with_traceback(exc_tb)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_three      |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_three      |     return dialect.connect(*cargs, **cparams)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_three      |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_three      |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_three      | sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_three      | 	Is the server running on that host and accepting TCP/IP connections?
broker_three      | 
broker_one        |     fairy = _ConnectionRecord.checkout(pool)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_one        |     rec = pool._do_get()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_one        |     self._dec_overflow()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_one        |     raise exc_value.with_traceback(exc_tb)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_one        |     return self._create_connection()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_one        |     return _ConnectionRecord(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_one        |     self.__connect()
broker_three      | (Background on this error at: https://sqlalche.me/e/20/e3q8)
broker_three      | Traceback (most recent call last):
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_three      |     self._dbapi_connection = engine.raw_connection()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_three      |     return self.pool.connect()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_three      |     return _ConnectionFairy._checkout(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_three      |     fairy = _ConnectionRecord.checkout(pool)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_three      |     rec = pool._do_get()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_three      |     self._dec_overflow()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_three      |     raise exc_value.with_traceback(exc_tb)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_three      |     return self._create_connection()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_three      |     return _ConnectionRecord(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_three      |     self.__connect()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_three      |     pool.logger.debug("Error on connect(): %s", e)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_three      |     raise exc_value.with_traceback(exc_tb)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_one        |     pool.logger.debug("Error on connect(): %s", e)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_one        |     raise exc_value.with_traceback(exc_tb)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_one        |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_one        |     return dialect.connect(*cargs, **cparams)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_one        |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_one        |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_one        | sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_one        | 	Is the server running on that host and accepting TCP/IP connections?
broker_one        | 
broker_one        | (Background on this error at: https://sqlalche.me/e/20/e3q8)
broker_one        | Traceback (most recent call last):
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_one        |     self._dbapi_connection = engine.raw_connection()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_one        |     return self.pool.connect()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_one        |     return _ConnectionFairy._checkout(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_one        |     fairy = _ConnectionRecord.checkout(pool)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_one        |     rec = pool._do_get()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_one        |     self._dec_overflow()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_one        |     raise exc_value.with_traceback(exc_tb)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_one        |     return self._create_connection()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_one        |     return _ConnectionRecord(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_one        |     self.__connect()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_one        |     pool.logger.debug("Error on connect(): %s", e)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_one        |     raise exc_value.with_traceback(exc_tb)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_one        |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_one        |     return dialect.connect(*cargs, **cparams)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_one        |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_one        |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_one        | psycopg2.OperationalError: connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_one        | 	Is the server running on that host and accepting TCP/IP connections?
broker_one        | 
broker_one        | 
broker_one        | The above exception was the direct cause of the following exception:
broker_three      |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_three      |     return dialect.connect(*cargs, **cparams)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_three      |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_three      |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_three      | psycopg2.OperationalError: connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_three      | 	Is the server running on that host and accepting TCP/IP connections?
broker_three      | 
broker_three      | 
broker_three      | The above exception was the direct cause of the following exception:
broker_three      | 
broker_three      | Traceback (most recent call last):
broker_three      |   File "/app/./Brokers/BrokerWrapper.py", line 148, in <module>
broker_three      |     db.create_all()  # <--- create db object.
broker_three      |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 884, in create_all
broker_three      |     self._call_for_binds(bind_key, "create_all")
broker_three      |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 865, in _call_for_binds
broker_three      |     getattr(metadata, op_name)(bind=engine)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/schema.py", line 5581, in create_all
broker_three      |     bind._run_ddl_visitor(
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3225, in _run_ddl_visitor
broker_three      |     with self.begin() as conn:
broker_three      |   File "/usr/local/lib/python3.9/contextlib.py", line 119, in __enter__
broker_three      |     return next(self.gen)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3215, in begin
broker_three      |     with self.connect() as conn:
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3251, in connect
broker_three      |     return self._connection_cls(self)
broker_one        | 
broker_one        | Traceback (most recent call last):
broker_one        |   File "/app/./Brokers/BrokerWrapper.py", line 148, in <module>
broker_one        |     db.create_all()  # <--- create db object.
broker_one        |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 884, in create_all
broker_one        |     self._call_for_binds(bind_key, "create_all")
broker_one        |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 865, in _call_for_binds
broker_one        |     getattr(metadata, op_name)(bind=engine)
broker_two        | Traceback (most recent call last):
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_two        |     self._dbapi_connection = engine.raw_connection()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_two        |     return self.pool.connect()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_two        |     return _ConnectionFairy._checkout(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_two        |     fairy = _ConnectionRecord.checkout(pool)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
broker_three      |     Connection._handle_dbapi_exception_noconnection(
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_two        |     rec = pool._do_get()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_two        |     self._dec_overflow()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2413, in _handle_dbapi_exception_noconnection
broker_three      |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_three      |     self._dbapi_connection = engine.raw_connection()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_three      |     return self.pool.connect()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_two        |     raise exc_value.with_traceback(exc_tb)
broker_three      |     return _ConnectionFairy._checkout(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_two        |     return self._create_connection()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_two        |     return _ConnectionRecord(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_two        |     self.__connect()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_two        |     pool.logger.debug("Error on connect(): %s", e)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_two        |     raise exc_value.with_traceback(exc_tb)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_two        |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_two        |     return dialect.connect(*cargs, **cparams)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_two        |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_two        |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_two        | psycopg2.OperationalError: connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_two        | 	Is the server running on that host and accepting TCP/IP connections?
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_three      |     fairy = _ConnectionRecord.checkout(pool)
broker_two        | 
broker_two        | 
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_three      |     rec = pool._do_get()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_three      |     self._dec_overflow()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_three      |     raise exc_value.with_traceback(exc_tb)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_three      |     return self._create_connection()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/schema.py", line 5581, in create_all
broker_one        |     bind._run_ddl_visitor(
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_three      |     return _ConnectionRecord(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_two        | The above exception was the direct cause of the following exception:
broker_two        | 
broker_three      |     self.__connect()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_three      |     pool.logger.debug("Error on connect(): %s", e)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_three      |     raise exc_value.with_traceback(exc_tb)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3225, in _run_ddl_visitor
broker_one        |     with self.begin() as conn:
broker_one        |   File "/usr/local/lib/python3.9/contextlib.py", line 119, in __enter__
broker_one        |     return next(self.gen)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3215, in begin
broker_one        |     with self.connect() as conn:
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3251, in connect
broker_one        |     return self._connection_cls(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_one        |     Connection._handle_dbapi_exception_noconnection(
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2413, in _handle_dbapi_exception_noconnection
broker_one        |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_one        |     self._dbapi_connection = engine.raw_connection()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_one        |     return self.pool.connect()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_one        |     return _ConnectionFairy._checkout(self)
broker_two        | Traceback (most recent call last):
broker_two        |   File "/app/./Brokers/BrokerWrapper.py", line 148, in <module>
broker_two        |     db.create_all()  # <--- create db object.
broker_two        |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 884, in create_all
broker_two        |     self._call_for_binds(bind_key, "create_all")
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_one        |     fairy = _ConnectionRecord.checkout(pool)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_one        |     rec = pool._do_get()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_one        |     self._dec_overflow()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_one        |     raise exc_value.with_traceback(exc_tb)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_one        |     return self._create_connection()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 865, in _call_for_binds
broker_two        |     getattr(metadata, op_name)(bind=engine)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/schema.py", line 5581, in create_all
broker_two        |     bind._run_ddl_visitor(
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3225, in _run_ddl_visitor
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_one        |     return _ConnectionRecord(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_one        |     self.__connect()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_three      |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_three      |     return dialect.connect(*cargs, **cparams)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_three      |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_two        |     with self.begin() as conn:
broker_two        |   File "/usr/local/lib/python3.9/contextlib.py", line 119, in __enter__
broker_two        |     return next(self.gen)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3215, in begin
broker_three      |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_three      | sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_three      | 	Is the server running on that host and accepting TCP/IP connections?
broker_three      | 
broker_two        |     with self.connect() as conn:
broker_three      | (Background on this error at: https://sqlalche.me/e/20/e3q8)
broker_three      | Traceback (most recent call last):
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_three      |     self._dbapi_connection = engine.raw_connection()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_three      |     return self.pool.connect()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_three      |     return _ConnectionFairy._checkout(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_three      |     fairy = _ConnectionRecord.checkout(pool)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_three      |     rec = pool._do_get()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_three      |     self._dec_overflow()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_three      |     raise exc_value.with_traceback(exc_tb)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_three      |     return self._create_connection()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_three      |     return _ConnectionRecord(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_three      |     self.__connect()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_three      |     pool.logger.debug("Error on connect(): %s", e)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3251, in connect
broker_two        |     return self._connection_cls(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
broker_two        |     Connection._handle_dbapi_exception_noconnection(
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2413, in _handle_dbapi_exception_noconnection
broker_two        |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_two        |     self._dbapi_connection = engine.raw_connection()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_three      |     raise exc_value.with_traceback(exc_tb)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_three      |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_three      |     return dialect.connect(*cargs, **cparams)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_three      |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_three      |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_three      | psycopg2.OperationalError: connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_three      | 	Is the server running on that host and accepting TCP/IP connections?
broker_three      | 
broker_three      | 
broker_three      | The above exception was the direct cause of the following exception:
broker_three      | 
broker_two        |     return self.pool.connect()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_two        |     return _ConnectionFairy._checkout(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_two        |     fairy = _ConnectionRecord.checkout(pool)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_two        |     rec = pool._do_get()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_two        |     self._dec_overflow()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_two        |     raise exc_value.with_traceback(exc_tb)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_two        |     return self._create_connection()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_two        |     return _ConnectionRecord(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_two        |     self.__connect()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_two        |     pool.logger.debug("Error on connect(): %s", e)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_two        |     raise exc_value.with_traceback(exc_tb)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_two        |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_two        |     return dialect.connect(*cargs, **cparams)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_two        |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_three      | Traceback (most recent call last):
broker_three      |   File "/app/./Brokers/BrokerWrapper.py", line 148, in <module>
broker_three      |     db.create_all()  # <--- create db object.
broker_three      |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 884, in create_all
broker_three      |     self._call_for_binds(bind_key, "create_all")
broker_three      |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 865, in _call_for_binds
broker_three      |     getattr(metadata, op_name)(bind=engine)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/schema.py", line 5581, in create_all
broker_three      |     bind._run_ddl_visitor(
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3225, in _run_ddl_visitor
broker_three      |     with self.begin() as conn:
broker_three      |   File "/usr/local/lib/python3.9/contextlib.py", line 119, in __enter__
broker_three      |     return next(self.gen)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3215, in begin
broker_three      |     with self.connect() as conn:
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3251, in connect
broker_three      |     return self._connection_cls(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
broker_three      |     Connection._handle_dbapi_exception_noconnection(
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2413, in _handle_dbapi_exception_noconnection
broker_three      |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_three      |     self._dbapi_connection = engine.raw_connection()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_three      |     return self.pool.connect()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_three      |     return _ConnectionFairy._checkout(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_three      |     fairy = _ConnectionRecord.checkout(pool)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_three      |     rec = pool._do_get()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_three      |     self._dec_overflow()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_three      |     raise exc_value.with_traceback(exc_tb)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_three      |     return self._create_connection()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_three      |     return _ConnectionRecord(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_one        |     pool.logger.debug("Error on connect(): %s", e)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_one        |     raise exc_value.with_traceback(exc_tb)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_one        |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_one        |     return dialect.connect(*cargs, **cparams)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_one        |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_one        |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_one        | sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_one        | 	Is the server running on that host and accepting TCP/IP connections?
broker_three      |     self.__connect()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_three      |     pool.logger.debug("Error on connect(): %s", e)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_three      |     raise exc_value.with_traceback(exc_tb)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_three      |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_three      |     return dialect.connect(*cargs, **cparams)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_three      |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_one        | 
broker_one        | (Background on this error at: https://sqlalche.me/e/20/e3q8)
broker_one        | Traceback (most recent call last):
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_one        |     self._dbapi_connection = engine.raw_connection()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_one        |     return self.pool.connect()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_one        |     return _ConnectionFairy._checkout(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_one        |     fairy = _ConnectionRecord.checkout(pool)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_one        |     rec = pool._do_get()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_one        |     self._dec_overflow()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_one        |     raise exc_value.with_traceback(exc_tb)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_one        |     return self._create_connection()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_one        |     return _ConnectionRecord(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_one        |     self.__connect()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_one        |     pool.logger.debug("Error on connect(): %s", e)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_one        |     raise exc_value.with_traceback(exc_tb)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_one        |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_two        |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_two        | sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_two        | 	Is the server running on that host and accepting TCP/IP connections?
broker_two        | 
broker_two        | (Background on this error at: https://sqlalche.me/e/20/e3q8)
broker_two        | Traceback (most recent call last):
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_two        |     self._dbapi_connection = engine.raw_connection()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_two        |     return self.pool.connect()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_two        |     return _ConnectionFairy._checkout(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_two        |     fairy = _ConnectionRecord.checkout(pool)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_one        |     return dialect.connect(*cargs, **cparams)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_one        |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_one        |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_one        | psycopg2.OperationalError: connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_one        | 	Is the server running on that host and accepting TCP/IP connections?
broker_one        | 
broker_one        | 
broker_one        | The above exception was the direct cause of the following exception:
broker_one        | 
broker_one        | Traceback (most recent call last):
broker_one        |   File "/app/./Brokers/BrokerWrapper.py", line 148, in <module>
broker_one        |     db.create_all()  # <--- create db object.
broker_one        |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 884, in create_all
broker_one        |     self._call_for_binds(bind_key, "create_all")
broker_one        |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 865, in _call_for_binds
broker_one        |     getattr(metadata, op_name)(bind=engine)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/schema.py", line 5581, in create_all
broker_one        |     bind._run_ddl_visitor(
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3225, in _run_ddl_visitor
broker_one        |     with self.begin() as conn:
broker_one        |   File "/usr/local/lib/python3.9/contextlib.py", line 119, in __enter__
broker_one        |     return next(self.gen)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3215, in begin
broker_one        |     with self.connect() as conn:
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3251, in connect
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_two        |     rec = pool._do_get()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_two        |     self._dec_overflow()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_two        |     raise exc_value.with_traceback(exc_tb)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_two        |     return self._create_connection()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_two        |     return _ConnectionRecord(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_two        |     self.__connect()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_two        |     pool.logger.debug("Error on connect(): %s", e)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_two        |     raise exc_value.with_traceback(exc_tb)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_two        |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_two        |     return dialect.connect(*cargs, **cparams)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_two        |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_two        |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_two        | psycopg2.OperationalError: connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_two        | 	Is the server running on that host and accepting TCP/IP connections?
broker_two        | 
broker_two        | 
broker_two        | The above exception was the direct cause of the following exception:
broker_two        | 
broker_two        | Traceback (most recent call last):
broker_two        |   File "/app/./Brokers/BrokerWrapper.py", line 148, in <module>
broker_two        |     db.create_all()  # <--- create db object.
broker_two        |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 884, in create_all
broker_two        |     self._call_for_binds(bind_key, "create_all")
broker_two        |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 865, in _call_for_binds
broker_two        |     getattr(metadata, op_name)(bind=engine)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/schema.py", line 5581, in create_all
broker_two        |     bind._run_ddl_visitor(
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3225, in _run_ddl_visitor
broker_one        |     return self._connection_cls(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
broker_one        |     Connection._handle_dbapi_exception_noconnection(
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2413, in _handle_dbapi_exception_noconnection
broker_one        |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_one        |     self._dbapi_connection = engine.raw_connection()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_one        |     return self.pool.connect()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_one        |     return _ConnectionFairy._checkout(self)
broker_two        |     with self.begin() as conn:
broker_two        |   File "/usr/local/lib/python3.9/contextlib.py", line 119, in __enter__
broker_two        |     return next(self.gen)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3215, in begin
broker_two        |     with self.connect() as conn:
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3251, in connect
broker_two        |     return self._connection_cls(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_one        |     fairy = _ConnectionRecord.checkout(pool)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_one        |     rec = pool._do_get()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_one        |     self._dec_overflow()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_one        |     raise exc_value.with_traceback(exc_tb)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_one        |     return self._create_connection()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_one        |     return _ConnectionRecord(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_one        |     self.__connect()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_three      |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_three      | sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_three      | 	Is the server running on that host and accepting TCP/IP connections?
broker_three      | 
broker_three      | (Background on this error at: https://sqlalche.me/e/20/e3q8)
broker_three      | Traceback (most recent call last):
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_three      |     self._dbapi_connection = engine.raw_connection()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_three      |     return self.pool.connect()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_three      |     return _ConnectionFairy._checkout(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_three      |     fairy = _ConnectionRecord.checkout(pool)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_three      |     rec = pool._do_get()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_three      |     self._dec_overflow()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_three      |     raise exc_value.with_traceback(exc_tb)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_three      |     return self._create_connection()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_three      |     return _ConnectionRecord(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_three      |     self.__connect()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_three      |     pool.logger.debug("Error on connect(): %s", e)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_three      |     raise exc_value.with_traceback(exc_tb)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_three      |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_three      |     return dialect.connect(*cargs, **cparams)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_three      |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_three      |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_three      | psycopg2.OperationalError: connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_three      | 	Is the server running on that host and accepting TCP/IP connections?
broker_two        |     Connection._handle_dbapi_exception_noconnection(
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2413, in _handle_dbapi_exception_noconnection
broker_two        |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_two        |     self._dbapi_connection = engine.raw_connection()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_two        |     return self.pool.connect()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_two        |     return _ConnectionFairy._checkout(self)
broker_three      | 
broker_three      | 
broker_three      | The above exception was the direct cause of the following exception:
broker_three      | 
broker_three      | Traceback (most recent call last):
broker_three      |   File "/app/./Brokers/BrokerWrapper.py", line 148, in <module>
broker_three      |     db.create_all()  # <--- create db object.
broker_three      |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 884, in create_all
broker_three      |     self._call_for_binds(bind_key, "create_all")
broker_three      |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 865, in _call_for_binds
broker_three      |     getattr(metadata, op_name)(bind=engine)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/schema.py", line 5581, in create_all
broker_three      |     bind._run_ddl_visitor(
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_two        |     fairy = _ConnectionRecord.checkout(pool)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_two        |     rec = pool._do_get()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_two        |     self._dec_overflow()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3225, in _run_ddl_visitor
broker_three      |     with self.begin() as conn:
broker_three      |   File "/usr/local/lib/python3.9/contextlib.py", line 119, in __enter__
broker_three      |     return next(self.gen)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3215, in begin
broker_three      |     with self.connect() as conn:
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3251, in connect
broker_three      |     return self._connection_cls(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
broker_three      |     Connection._handle_dbapi_exception_noconnection(
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2413, in _handle_dbapi_exception_noconnection
broker_three      |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_three      |     self._dbapi_connection = engine.raw_connection()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_three      |     return self.pool.connect()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_three      |     return _ConnectionFairy._checkout(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_three      |     fairy = _ConnectionRecord.checkout(pool)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_one        |     pool.logger.debug("Error on connect(): %s", e)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_one        |     raise exc_value.with_traceback(exc_tb)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_one        |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_one        |     return dialect.connect(*cargs, **cparams)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_one        |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_one        |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_one        | sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_one        | 	Is the server running on that host and accepting TCP/IP connections?
broker_one        | 
broker_one        | (Background on this error at: https://sqlalche.me/e/20/e3q8)
broker_one        | Traceback (most recent call last):
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_one        |     self._dbapi_connection = engine.raw_connection()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_one        |     return self.pool.connect()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_one        |     return _ConnectionFairy._checkout(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_one        |     fairy = _ConnectionRecord.checkout(pool)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_one        |     rec = pool._do_get()
broker_three      |     rec = pool._do_get()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_three      |     self._dec_overflow()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_three      |     raise exc_value.with_traceback(exc_tb)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_three      |     return self._create_connection()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_three      |     return _ConnectionRecord(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_three      |     self.__connect()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_three      |     pool.logger.debug("Error on connect(): %s", e)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_three      |     raise exc_value.with_traceback(exc_tb)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_three      |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_three      |     return dialect.connect(*cargs, **cparams)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_three      |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_two        |     raise exc_value.with_traceback(exc_tb)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_two        |     return self._create_connection()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_two        |     return _ConnectionRecord(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_two        |     self.__connect()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_two        |     pool.logger.debug("Error on connect(): %s", e)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_two        |     raise exc_value.with_traceback(exc_tb)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_two        |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_two        |     return dialect.connect(*cargs, **cparams)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_two        |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_three      |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_three      | sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_three      | 	Is the server running on that host and accepting TCP/IP connections?
broker_two        |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_two        | sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_two        | 	Is the server running on that host and accepting TCP/IP connections?
broker_two        | 
broker_two        | (Background on this error at: https://sqlalche.me/e/20/e3q8)
broker_two        | Traceback (most recent call last):
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_one        |     self._dec_overflow()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_two        |     self._dbapi_connection = engine.raw_connection()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_one        |     raise exc_value.with_traceback(exc_tb)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_one        |     return self._create_connection()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_one        |     return _ConnectionRecord(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_one        |     self.__connect()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_one        |     pool.logger.debug("Error on connect(): %s", e)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_two        |     return self.pool.connect()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_three      | 
broker_three      | (Background on this error at: https://sqlalche.me/e/20/e3q8)
broker_three      | Traceback (most recent call last):
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_one        |     raise exc_value.with_traceback(exc_tb)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_one        |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_one        |     return dialect.connect(*cargs, **cparams)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_one        |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_one        |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_one        | psycopg2.OperationalError: connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_one        | 	Is the server running on that host and accepting TCP/IP connections?
broker_one        | 
broker_one        | 
broker_two        |     return _ConnectionFairy._checkout(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_two        |     fairy = _ConnectionRecord.checkout(pool)
broker_three      |     self._dbapi_connection = engine.raw_connection()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_three      |     return self.pool.connect()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_three      |     return _ConnectionFairy._checkout(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_two        |     rec = pool._do_get()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_two        |     self._dec_overflow()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_two        |     raise exc_value.with_traceback(exc_tb)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_two        |     return self._create_connection()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_one        | The above exception was the direct cause of the following exception:
broker_one        | 
broker_one        | Traceback (most recent call last):
broker_one        |   File "/app/./Brokers/BrokerWrapper.py", line 148, in <module>
broker_one        |     db.create_all()  # <--- create db object.
broker_one        |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 884, in create_all
broker_one        |     self._call_for_binds(bind_key, "create_all")
broker_one        |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 865, in _call_for_binds
broker_one        |     getattr(metadata, op_name)(bind=engine)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/schema.py", line 5581, in create_all
broker_three      |     fairy = _ConnectionRecord.checkout(pool)
broker_one        |     bind._run_ddl_visitor(
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3225, in _run_ddl_visitor
broker_one        |     with self.begin() as conn:
broker_one        |   File "/usr/local/lib/python3.9/contextlib.py", line 119, in __enter__
broker_one        |     return next(self.gen)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3215, in begin
broker_one        |     with self.connect() as conn:
broker_two        |     return _ConnectionRecord(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3251, in connect
broker_one        |     return self._connection_cls(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
broker_one        |     Connection._handle_dbapi_exception_noconnection(
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2413, in _handle_dbapi_exception_noconnection
broker_one        |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_one        |     self._dbapi_connection = engine.raw_connection()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_two        |     self.__connect()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_two        |     pool.logger.debug("Error on connect(): %s", e)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_two        |     raise exc_value.with_traceback(exc_tb)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_two        |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_two        |     return dialect.connect(*cargs, **cparams)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_two        |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_two        |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_two        | psycopg2.OperationalError: connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_two        | 	Is the server running on that host and accepting TCP/IP connections?
broker_two        | 
broker_two        | 
broker_two        | The above exception was the direct cause of the following exception:
broker_two        | 
broker_two        | Traceback (most recent call last):
broker_two        |   File "/app/./Brokers/BrokerWrapper.py", line 148, in <module>
broker_one        |     return self.pool.connect()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_one        |     return _ConnectionFairy._checkout(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_one        |     fairy = _ConnectionRecord.checkout(pool)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_one        |     rec = pool._do_get()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_one        |     self._dec_overflow()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_one        |     raise exc_value.with_traceback(exc_tb)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_one        |     return self._create_connection()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_one        |     return _ConnectionRecord(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_one        |     self.__connect()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_one        |     pool.logger.debug("Error on connect(): %s", e)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_one        |     raise exc_value.with_traceback(exc_tb)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_one        |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_one        |     return dialect.connect(*cargs, **cparams)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_one        |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_one        |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_one        | sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_one        | 	Is the server running on that host and accepting TCP/IP connections?
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_three      |     rec = pool._do_get()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_three      |     self._dec_overflow()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_three      |     raise exc_value.with_traceback(exc_tb)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_three      |     return self._create_connection()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_three      |     return _ConnectionRecord(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_three      |     self.__connect()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_three      |     pool.logger.debug("Error on connect(): %s", e)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_three      |     raise exc_value.with_traceback(exc_tb)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_three      |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_one        | 
broker_one        | (Background on this error at: https://sqlalche.me/e/20/e3q8)
broker_one        | Traceback (most recent call last):
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_one        |     self._dbapi_connection = engine.raw_connection()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_one        |     return self.pool.connect()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_one        |     return _ConnectionFairy._checkout(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_one        |     fairy = _ConnectionRecord.checkout(pool)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_one        |     rec = pool._do_get()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_one        |     self._dec_overflow()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_one        |     raise exc_value.with_traceback(exc_tb)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_one        |     return self._create_connection()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_one        |     return _ConnectionRecord(self)
broker_three      |     return dialect.connect(*cargs, **cparams)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_three      |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_three      |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_three      | psycopg2.OperationalError: connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_three      | 	Is the server running on that host and accepting TCP/IP connections?
broker_three      | 
broker_three      | 
broker_three      | The above exception was the direct cause of the following exception:
broker_three      | 
broker_three      | Traceback (most recent call last):
broker_three      |   File "/app/./Brokers/BrokerWrapper.py", line 148, in <module>
broker_three      |     db.create_all()  # <--- create db object.
broker_three      |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 884, in create_all
broker_three      |     self._call_for_binds(bind_key, "create_all")
broker_three      |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 865, in _call_for_binds
broker_three      |     getattr(metadata, op_name)(bind=engine)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/schema.py", line 5581, in create_all
broker_three      |     bind._run_ddl_visitor(
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3225, in _run_ddl_visitor
broker_three      |     with self.begin() as conn:
broker_three      |   File "/usr/local/lib/python3.9/contextlib.py", line 119, in __enter__
broker_three      |     return next(self.gen)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3215, in begin
broker_three      |     with self.connect() as conn:
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_two        |     db.create_all()  # <--- create db object.
broker_two        |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 884, in create_all
broker_two        |     self._call_for_binds(bind_key, "create_all")
broker_two        |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 865, in _call_for_binds
broker_two        |     getattr(metadata, op_name)(bind=engine)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/schema.py", line 5581, in create_all
broker_two        |     bind._run_ddl_visitor(
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3225, in _run_ddl_visitor
broker_two        |     with self.begin() as conn:
broker_two        |   File "/usr/local/lib/python3.9/contextlib.py", line 119, in __enter__
broker_one        |     self.__connect()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_one        |     pool.logger.debug("Error on connect(): %s", e)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_two        |     return next(self.gen)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3215, in begin
broker_two        |     with self.connect() as conn:
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3251, in connect
broker_two        |     return self._connection_cls(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
broker_two        |     Connection._handle_dbapi_exception_noconnection(
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2413, in _handle_dbapi_exception_noconnection
broker_two        |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_two        |     self._dbapi_connection = engine.raw_connection()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_two        |     return self.pool.connect()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_two        |     return _ConnectionFairy._checkout(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_two        |     fairy = _ConnectionRecord.checkout(pool)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_two        |     rec = pool._do_get()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3251, in connect
broker_three      |     return self._connection_cls(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
broker_three      |     Connection._handle_dbapi_exception_noconnection(
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2413, in _handle_dbapi_exception_noconnection
broker_three      |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_three      |     self._dbapi_connection = engine.raw_connection()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_two        |     self._dec_overflow()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_two        |     raise exc_value.with_traceback(exc_tb)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_two        |     return self._create_connection()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_two        |     return _ConnectionRecord(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_two        |     self.__connect()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_two        |     pool.logger.debug("Error on connect(): %s", e)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_two        |     raise exc_value.with_traceback(exc_tb)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_two        |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_two        |     return dialect.connect(*cargs, **cparams)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_two        |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_two        |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_two        | sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_two        | 	Is the server running on that host and accepting TCP/IP connections?
broker_two        | 
broker_two        | (Background on this error at: https://sqlalche.me/e/20/e3q8)
broker_two        | Traceback (most recent call last):
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_two        |     self._dbapi_connection = engine.raw_connection()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_two        |     return self.pool.connect()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_two        |     return _ConnectionFairy._checkout(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_two        |     fairy = _ConnectionRecord.checkout(pool)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_two        |     rec = pool._do_get()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_two        |     self._dec_overflow()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_two        |     raise exc_value.with_traceback(exc_tb)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_three      |     return self.pool.connect()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_three      |     return _ConnectionFairy._checkout(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_three      |     fairy = _ConnectionRecord.checkout(pool)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_three      |     rec = pool._do_get()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_three      |     self._dec_overflow()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_two        |     return self._create_connection()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_two        |     return _ConnectionRecord(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_two        |     self.__connect()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_two        |     pool.logger.debug("Error on connect(): %s", e)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_two        |     raise exc_value.with_traceback(exc_tb)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_two        |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_two        |     return dialect.connect(*cargs, **cparams)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_two        |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_two        |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_two        | psycopg2.OperationalError: connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_two        | 	Is the server running on that host and accepting TCP/IP connections?
broker_two        | 
broker_two        | 
broker_two        | The above exception was the direct cause of the following exception:
broker_two        | 
broker_two        | Traceback (most recent call last):
broker_two        |   File "/app/./Brokers/BrokerWrapper.py", line 148, in <module>
broker_two        |     db.create_all()  # <--- create db object.
broker_two        |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 884, in create_all
broker_two        |     self._call_for_binds(bind_key, "create_all")
broker_two        |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 865, in _call_for_binds
broker_two        |     getattr(metadata, op_name)(bind=engine)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/schema.py", line 5581, in create_all
broker_two        |     bind._run_ddl_visitor(
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3225, in _run_ddl_visitor
broker_two        |     with self.begin() as conn:
broker_two        |   File "/usr/local/lib/python3.9/contextlib.py", line 119, in __enter__
broker_two        |     return next(self.gen)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3215, in begin
broker_two        |     with self.connect() as conn:
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3251, in connect
broker_two        |     return self._connection_cls(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
broker_two        |     Connection._handle_dbapi_exception_noconnection(
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2413, in _handle_dbapi_exception_noconnection
broker_two        |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_two        |     self._dbapi_connection = engine.raw_connection()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_two        |     return self.pool.connect()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_two        |     return _ConnectionFairy._checkout(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_two        |     fairy = _ConnectionRecord.checkout(pool)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_two        |     rec = pool._do_get()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_two        |     self._dec_overflow()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_two        |     raise exc_value.with_traceback(exc_tb)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_two        |     return self._create_connection()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_two        |     return _ConnectionRecord(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_two        |     self.__connect()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_two        |     pool.logger.debug("Error on connect(): %s", e)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_two        |     raise exc_value.with_traceback(exc_tb)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_two        |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_one        |     raise exc_value.with_traceback(exc_tb)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_one        |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_one        |     return dialect.connect(*cargs, **cparams)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_one        |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_one        |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_two        |     return dialect.connect(*cargs, **cparams)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_two        |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_three      |     raise exc_value.with_traceback(exc_tb)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_three      |     return self._create_connection()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_three      |     return _ConnectionRecord(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_three      |     self.__connect()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_three      |     pool.logger.debug("Error on connect(): %s", e)
broker_one        | psycopg2.OperationalError: connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_one        | 	Is the server running on that host and accepting TCP/IP connections?
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_three      |     raise exc_value.with_traceback(exc_tb)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_three      |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_three      |     return dialect.connect(*cargs, **cparams)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_three      |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_two        |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_two        | sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_two        | 	Is the server running on that host and accepting TCP/IP connections?
broker_two        | 
broker_two        | (Background on this error at: https://sqlalche.me/e/20/e3q8)
broker_two        | Traceback (most recent call last):
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_two        |     self._dbapi_connection = engine.raw_connection()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_two        |     return self.pool.connect()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_two        |     return _ConnectionFairy._checkout(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_two        |     fairy = _ConnectionRecord.checkout(pool)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_two        |     rec = pool._do_get()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_two        |     self._dec_overflow()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_one        | 
broker_one        | 
broker_one        | The above exception was the direct cause of the following exception:
broker_one        | 
broker_one        | Traceback (most recent call last):
broker_one        |   File "/app/./Brokers/BrokerWrapper.py", line 148, in <module>
broker_one        |     db.create_all()  # <--- create db object.
broker_one        |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 884, in create_all
broker_one        |     self._call_for_binds(bind_key, "create_all")
broker_one        |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 865, in _call_for_binds
broker_one        |     getattr(metadata, op_name)(bind=engine)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/schema.py", line 5581, in create_all
broker_three      |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_three      |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_three      | sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_three      | 	Is the server running on that host and accepting TCP/IP connections?
broker_three      | 
broker_three      | (Background on this error at: https://sqlalche.me/e/20/e3q8)
broker_three      | Traceback (most recent call last):
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_three      |     self._dbapi_connection = engine.raw_connection()
broker_one        |     bind._run_ddl_visitor(
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3225, in _run_ddl_visitor
broker_one        |     with self.begin() as conn:
broker_one        |   File "/usr/local/lib/python3.9/contextlib.py", line 119, in __enter__
broker_one        |     return next(self.gen)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3215, in begin
broker_one        |     with self.connect() as conn:
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3251, in connect
broker_one        |     return self._connection_cls(self)
broker_two        |     raise exc_value.with_traceback(exc_tb)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_two        |     return self._create_connection()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_two        |     return _ConnectionRecord(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_two        |     self.__connect()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_three      |     return self.pool.connect()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_three      |     return _ConnectionFairy._checkout(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_three      |     fairy = _ConnectionRecord.checkout(pool)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_three      |     rec = pool._do_get()
broker_two        |     pool.logger.debug("Error on connect(): %s", e)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_two        |     raise exc_value.with_traceback(exc_tb)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_three      |     self._dec_overflow()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_three      |     raise exc_value.with_traceback(exc_tb)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_three      |     return self._create_connection()
broker_two        |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_two        |     return dialect.connect(*cargs, **cparams)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_two        |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_two        |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
broker_one        |     Connection._handle_dbapi_exception_noconnection(
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2413, in _handle_dbapi_exception_noconnection
broker_one        |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_two        | psycopg2.OperationalError: connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_two        | 	Is the server running on that host and accepting TCP/IP connections?
broker_one        |     self._dbapi_connection = engine.raw_connection()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_two        | 
broker_two        | 
broker_two        | The above exception was the direct cause of the following exception:
broker_two        | 
broker_two        | Traceback (most recent call last):
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_three      |     return _ConnectionRecord(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_three      |     self.__connect()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_three      |     pool.logger.debug("Error on connect(): %s", e)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_three      |     raise exc_value.with_traceback(exc_tb)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_three      |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_two        |   File "/app/./Brokers/BrokerWrapper.py", line 148, in <module>
broker_two        |     db.create_all()  # <--- create db object.
broker_two        |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 884, in create_all
broker_two        |     self._call_for_binds(bind_key, "create_all")
broker_two        |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 865, in _call_for_binds
broker_two        |     getattr(metadata, op_name)(bind=engine)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/schema.py", line 5581, in create_all
broker_two        |     bind._run_ddl_visitor(
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3225, in _run_ddl_visitor
broker_two        |     with self.begin() as conn:
broker_two        |   File "/usr/local/lib/python3.9/contextlib.py", line 119, in __enter__
broker_two        |     return next(self.gen)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3215, in begin
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_three      |     return dialect.connect(*cargs, **cparams)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_three      |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_three      |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_three      | psycopg2.OperationalError: connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_three      | 	Is the server running on that host and accepting TCP/IP connections?
broker_three      | 
broker_three      | 
broker_three      | The above exception was the direct cause of the following exception:
broker_three      | 
broker_one        |     return self.pool.connect()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_one        |     return _ConnectionFairy._checkout(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_one        |     fairy = _ConnectionRecord.checkout(pool)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_one        |     rec = pool._do_get()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_one        |     self._dec_overflow()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_one        |     raise exc_value.with_traceback(exc_tb)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_one        |     return self._create_connection()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_one        |     return _ConnectionRecord(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_one        |     self.__connect()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_one        |     pool.logger.debug("Error on connect(): %s", e)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_one        |     raise exc_value.with_traceback(exc_tb)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_one        |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_one        |     return dialect.connect(*cargs, **cparams)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_one        |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_one        |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_one        | sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_three      | Traceback (most recent call last):
broker_three      |   File "/app/./Brokers/BrokerWrapper.py", line 148, in <module>
broker_three      |     db.create_all()  # <--- create db object.
broker_three      |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 884, in create_all
broker_three      |     self._call_for_binds(bind_key, "create_all")
broker_three      |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 865, in _call_for_binds
broker_three      |     getattr(metadata, op_name)(bind=engine)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/schema.py", line 5581, in create_all
broker_three      |     bind._run_ddl_visitor(
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3225, in _run_ddl_visitor
broker_three      |     with self.begin() as conn:
broker_three      |   File "/usr/local/lib/python3.9/contextlib.py", line 119, in __enter__
broker_three      |     return next(self.gen)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3215, in begin
broker_three      |     with self.connect() as conn:
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3251, in connect
broker_three      |     return self._connection_cls(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
broker_three      |     Connection._handle_dbapi_exception_noconnection(
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2413, in _handle_dbapi_exception_noconnection
broker_one        | 	Is the server running on that host and accepting TCP/IP connections?
broker_one        | 
broker_one        | (Background on this error at: https://sqlalche.me/e/20/e3q8)
broker_one        | Traceback (most recent call last):
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_one        |     self._dbapi_connection = engine.raw_connection()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_one        |     return self.pool.connect()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_one        |     return _ConnectionFairy._checkout(self)
broker_three      |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_three      |     self._dbapi_connection = engine.raw_connection()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_three      |     return self.pool.connect()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_three      |     return _ConnectionFairy._checkout(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_three      |     fairy = _ConnectionRecord.checkout(pool)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_three      |     rec = pool._do_get()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_one        |     fairy = _ConnectionRecord.checkout(pool)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_one        |     rec = pool._do_get()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_one        |     self._dec_overflow()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_one        |     raise exc_value.with_traceback(exc_tb)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_one        |     return self._create_connection()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_one        |     return _ConnectionRecord(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_one        |     self.__connect()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_one        |     pool.logger.debug("Error on connect(): %s", e)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_one        |     raise exc_value.with_traceback(exc_tb)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_one        |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_three      |     self._dec_overflow()
broker_one        |     return dialect.connect(*cargs, **cparams)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_one        |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_one        |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_one        | psycopg2.OperationalError: connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_one        | 	Is the server running on that host and accepting TCP/IP connections?
broker_one        | 
broker_two        |     with self.connect() as conn:
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3251, in connect
broker_two        |     return self._connection_cls(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
broker_two        |     Connection._handle_dbapi_exception_noconnection(
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2413, in _handle_dbapi_exception_noconnection
broker_two        |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_two        |     self._dbapi_connection = engine.raw_connection()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_two        |     return self.pool.connect()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_two        |     return _ConnectionFairy._checkout(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_two        |     fairy = _ConnectionRecord.checkout(pool)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_two        |     rec = pool._do_get()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_two        |     self._dec_overflow()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_two        |     raise exc_value.with_traceback(exc_tb)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_three      |     raise exc_value.with_traceback(exc_tb)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_three      |     return self._create_connection()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_three      |     return _ConnectionRecord(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_three      |     self.__connect()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_three      |     pool.logger.debug("Error on connect(): %s", e)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_two        |     return self._create_connection()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_two        |     return _ConnectionRecord(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_two        |     self.__connect()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_three      |     raise exc_value.with_traceback(exc_tb)
broker_one        | 
broker_one        | The above exception was the direct cause of the following exception:
broker_one        | 
broker_one        | Traceback (most recent call last):
broker_one        |   File "/app/./Brokers/BrokerWrapper.py", line 148, in <module>
broker_one        |     db.create_all()  # <--- create db object.
broker_one        |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 884, in create_all
broker_one        |     self._call_for_binds(bind_key, "create_all")
broker_one        |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 865, in _call_for_binds
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_three      |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_three      |     return dialect.connect(*cargs, **cparams)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_three      |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_three      |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_three      | sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_three      | 	Is the server running on that host and accepting TCP/IP connections?
broker_three      | 
broker_three      | (Background on this error at: https://sqlalche.me/e/20/e3q8)
broker_one        |     getattr(metadata, op_name)(bind=engine)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/schema.py", line 5581, in create_all
broker_one        |     bind._run_ddl_visitor(
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3225, in _run_ddl_visitor
broker_one        |     with self.begin() as conn:
broker_one        |   File "/usr/local/lib/python3.9/contextlib.py", line 119, in __enter__
broker_one        |     return next(self.gen)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3215, in begin
broker_one        |     with self.connect() as conn:
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3251, in connect
broker_one        |     return self._connection_cls(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
broker_one        |     Connection._handle_dbapi_exception_noconnection(
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2413, in _handle_dbapi_exception_noconnection
broker_one        |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_one        |     self._dbapi_connection = engine.raw_connection()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_one        |     return self.pool.connect()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_three      | Traceback (most recent call last):
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_three      |     self._dbapi_connection = engine.raw_connection()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_three      |     return self.pool.connect()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_three      |     return _ConnectionFairy._checkout(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_three      |     fairy = _ConnectionRecord.checkout(pool)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_three      |     rec = pool._do_get()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_three      |     self._dec_overflow()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_three      |     raise exc_value.with_traceback(exc_tb)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_three      |     return self._create_connection()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_three      |     return _ConnectionRecord(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_three      |     self.__connect()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_three      |     pool.logger.debug("Error on connect(): %s", e)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_one        |     return _ConnectionFairy._checkout(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_one        |     fairy = _ConnectionRecord.checkout(pool)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_one        |     rec = pool._do_get()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_one        |     self._dec_overflow()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_one        |     raise exc_value.with_traceback(exc_tb)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_one        |     return self._create_connection()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_one        |     return _ConnectionRecord(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_one        |     self.__connect()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_one        |     pool.logger.debug("Error on connect(): %s", e)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_one        |     raise exc_value.with_traceback(exc_tb)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_one        |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_one        |     return dialect.connect(*cargs, **cparams)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_one        |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_three      |     raise exc_value.with_traceback(exc_tb)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_three      |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_three      |     return dialect.connect(*cargs, **cparams)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_three      |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_three      |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_three      | psycopg2.OperationalError: connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_three      | 	Is the server running on that host and accepting TCP/IP connections?
broker_three      | 
broker_three      | 
broker_three      | The above exception was the direct cause of the following exception:
broker_three      | 
broker_three      | Traceback (most recent call last):
broker_three      |   File "/app/./Brokers/BrokerWrapper.py", line 148, in <module>
broker_three      |     db.create_all()  # <--- create db object.
broker_three      |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 884, in create_all
broker_three      |     self._call_for_binds(bind_key, "create_all")
broker_three      |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 865, in _call_for_binds
broker_three      |     getattr(metadata, op_name)(bind=engine)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/schema.py", line 5581, in create_all
broker_three      |     bind._run_ddl_visitor(
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3225, in _run_ddl_visitor
broker_one        |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_one        | sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_one        | 	Is the server running on that host and accepting TCP/IP connections?
broker_one        | 
broker_one        | (Background on this error at: https://sqlalche.me/e/20/e3q8)
broker_one        | Traceback (most recent call last):
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_one        |     self._dbapi_connection = engine.raw_connection()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_one        |     return self.pool.connect()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_one        |     return _ConnectionFairy._checkout(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_one        |     fairy = _ConnectionRecord.checkout(pool)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_one        |     rec = pool._do_get()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_one        |     self._dec_overflow()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_one        |     raise exc_value.with_traceback(exc_tb)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_one        |     return self._create_connection()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_one        |     return _ConnectionRecord(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_one        |     self.__connect()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_one        |     pool.logger.debug("Error on connect(): %s", e)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_one        |     raise exc_value.with_traceback(exc_tb)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_one        |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_one        |     return dialect.connect(*cargs, **cparams)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_one        |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_one        |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_two        |     pool.logger.debug("Error on connect(): %s", e)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_two        |     raise exc_value.with_traceback(exc_tb)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_two        |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_two        |     return dialect.connect(*cargs, **cparams)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_two        |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_two        |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_two        | sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_two        | 	Is the server running on that host and accepting TCP/IP connections?
broker_two        | 
broker_two        | (Background on this error at: https://sqlalche.me/e/20/e3q8)
broker_one        | psycopg2.OperationalError: connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_one        | 	Is the server running on that host and accepting TCP/IP connections?
broker_one        | 
broker_one        | 
broker_one        | The above exception was the direct cause of the following exception:
broker_one        | 
broker_one        | Traceback (most recent call last):
broker_one        |   File "/app/./Brokers/BrokerWrapper.py", line 148, in <module>
broker_one        |     db.create_all()  # <--- create db object.
broker_one        |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 884, in create_all
broker_one        |     self._call_for_binds(bind_key, "create_all")
broker_two        | Traceback (most recent call last):
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_two        |     self._dbapi_connection = engine.raw_connection()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_two        |     return self.pool.connect()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_two        |     return _ConnectionFairy._checkout(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_two        |     fairy = _ConnectionRecord.checkout(pool)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_two        |     rec = pool._do_get()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_two        |     self._dec_overflow()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_two        |     raise exc_value.with_traceback(exc_tb)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_two        |     return self._create_connection()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_two        |     return _ConnectionRecord(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_two        |     self.__connect()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_two        |     pool.logger.debug("Error on connect(): %s", e)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_two        |     raise exc_value.with_traceback(exc_tb)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_two        |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_three      |     with self.begin() as conn:
broker_three      |   File "/usr/local/lib/python3.9/contextlib.py", line 119, in __enter__
broker_three      |     return next(self.gen)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3215, in begin
broker_three      |     with self.connect() as conn:
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3251, in connect
broker_three      |     return self._connection_cls(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
broker_three      |     Connection._handle_dbapi_exception_noconnection(
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2413, in _handle_dbapi_exception_noconnection
broker_three      |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_three      |     self._dbapi_connection = engine.raw_connection()
broker_two        |     return dialect.connect(*cargs, **cparams)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_two        |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_two        |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_two        | psycopg2.OperationalError: connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_two        | 	Is the server running on that host and accepting TCP/IP connections?
broker_two        | 
broker_two        | 
broker_two        | The above exception was the direct cause of the following exception:
broker_two        | 
broker_two        | Traceback (most recent call last):
broker_two        |   File "/app/./Brokers/BrokerWrapper.py", line 148, in <module>
broker_two        |     db.create_all()  # <--- create db object.
broker_two        |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 884, in create_all
broker_two        |     self._call_for_binds(bind_key, "create_all")
broker_two        |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 865, in _call_for_binds
broker_two        |     getattr(metadata, op_name)(bind=engine)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/schema.py", line 5581, in create_all
broker_two        |     bind._run_ddl_visitor(
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3225, in _run_ddl_visitor
broker_two        |     with self.begin() as conn:
broker_two        |   File "/usr/local/lib/python3.9/contextlib.py", line 119, in __enter__
broker_two        |     return next(self.gen)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3215, in begin
broker_two        |     with self.connect() as conn:
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3251, in connect
broker_two        |     return self._connection_cls(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
broker_two        |     Connection._handle_dbapi_exception_noconnection(
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2413, in _handle_dbapi_exception_noconnection
broker_two        |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_two        |     self._dbapi_connection = engine.raw_connection()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_two        |     return self.pool.connect()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_two        |     return _ConnectionFairy._checkout(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_two        |     fairy = _ConnectionRecord.checkout(pool)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_two        |     rec = pool._do_get()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_two        |     self._dec_overflow()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_two        |     raise exc_value.with_traceback(exc_tb)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_two        |     return self._create_connection()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_two        |     return _ConnectionRecord(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_two        |     self.__connect()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_two        |     pool.logger.debug("Error on connect(): %s", e)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_two        |     raise exc_value.with_traceback(exc_tb)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_two        |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_two        |     return dialect.connect(*cargs, **cparams)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_two        |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_two        |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_two        | sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_two        | 	Is the server running on that host and accepting TCP/IP connections?
broker_two        | 
broker_two        | (Background on this error at: https://sqlalche.me/e/20/e3q8)
broker_two        | Traceback (most recent call last):
broker_one        |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 865, in _call_for_binds
broker_one        |     getattr(metadata, op_name)(bind=engine)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/schema.py", line 5581, in create_all
broker_one        |     bind._run_ddl_visitor(
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3225, in _run_ddl_visitor
broker_one        |     with self.begin() as conn:
broker_one        |   File "/usr/local/lib/python3.9/contextlib.py", line 119, in __enter__
broker_one        |     return next(self.gen)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3215, in begin
broker_one        |     with self.connect() as conn:
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3251, in connect
broker_one        |     return self._connection_cls(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
broker_one        |     Connection._handle_dbapi_exception_noconnection(
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2413, in _handle_dbapi_exception_noconnection
broker_one        |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_one        |     self._dbapi_connection = engine.raw_connection()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_one        |     return self.pool.connect()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_one        |     return _ConnectionFairy._checkout(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_one        |     fairy = _ConnectionRecord.checkout(pool)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_one        |     rec = pool._do_get()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_one        |     self._dec_overflow()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_one        |     raise exc_value.with_traceback(exc_tb)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_one        |     return self._create_connection()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_one        |     return _ConnectionRecord(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_one        |     self.__connect()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_one        |     pool.logger.debug("Error on connect(): %s", e)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_one        |     raise exc_value.with_traceback(exc_tb)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_one        |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_one        |     return dialect.connect(*cargs, **cparams)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_one        |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_one        |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_one        | sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_one        | 	Is the server running on that host and accepting TCP/IP connections?
broker_one        | 
broker_one        | (Background on this error at: https://sqlalche.me/e/20/e3q8)
broker_one        | Traceback (most recent call last):
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_one        |     self._dbapi_connection = engine.raw_connection()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_three      |     return self.pool.connect()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_three      |     return _ConnectionFairy._checkout(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_three      |     fairy = _ConnectionRecord.checkout(pool)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_three      |     rec = pool._do_get()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_three      |     self._dec_overflow()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_one        |     return self.pool.connect()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_one        |     return _ConnectionFairy._checkout(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_one        |     fairy = _ConnectionRecord.checkout(pool)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_one        |     rec = pool._do_get()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_one        |     self._dec_overflow()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_one        |     raise exc_value.with_traceback(exc_tb)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_one        |     return self._create_connection()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_one        |     return _ConnectionRecord(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_one        |     self.__connect()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_one        |     pool.logger.debug("Error on connect(): %s", e)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_three      |     raise exc_value.with_traceback(exc_tb)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_three      |     return self._create_connection()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_three      |     return _ConnectionRecord(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_three      |     self.__connect()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_three      |     pool.logger.debug("Error on connect(): %s", e)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_three      |     raise exc_value.with_traceback(exc_tb)
broker_one        |     raise exc_value.with_traceback(exc_tb)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_one        |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_one        |     return dialect.connect(*cargs, **cparams)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_one        |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_one        |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_one        | psycopg2.OperationalError: connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_one        | 	Is the server running on that host and accepting TCP/IP connections?
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_three      |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_three      |     return dialect.connect(*cargs, **cparams)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_three      |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_three      |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_three      | sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_one        | 
broker_one        | 
broker_one        | The above exception was the direct cause of the following exception:
broker_one        | 
broker_one        | Traceback (most recent call last):
broker_one        |   File "/app/./Brokers/BrokerWrapper.py", line 148, in <module>
broker_one        |     db.create_all()  # <--- create db object.
broker_one        |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 884, in create_all
broker_one        |     self._call_for_binds(bind_key, "create_all")
broker_one        |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 865, in _call_for_binds
broker_one        |     getattr(metadata, op_name)(bind=engine)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/schema.py", line 5581, in create_all
broker_one        |     bind._run_ddl_visitor(
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3225, in _run_ddl_visitor
broker_one        |     with self.begin() as conn:
broker_one        |   File "/usr/local/lib/python3.9/contextlib.py", line 119, in __enter__
broker_one        |     return next(self.gen)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3215, in begin
broker_one        |     with self.connect() as conn:
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3251, in connect
broker_one        |     return self._connection_cls(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
broker_one        |     Connection._handle_dbapi_exception_noconnection(
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2413, in _handle_dbapi_exception_noconnection
broker_one        |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_one        |     self._dbapi_connection = engine.raw_connection()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_one        |     return self.pool.connect()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_one        |     return _ConnectionFairy._checkout(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_one        |     fairy = _ConnectionRecord.checkout(pool)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_one        |     rec = pool._do_get()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_one        |     self._dec_overflow()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_one        |     raise exc_value.with_traceback(exc_tb)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_one        |     return self._create_connection()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_three      | 	Is the server running on that host and accepting TCP/IP connections?
broker_three      | 
broker_three      | (Background on this error at: https://sqlalche.me/e/20/e3q8)
broker_three      | Traceback (most recent call last):
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_three      |     self._dbapi_connection = engine.raw_connection()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_three      |     return self.pool.connect()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_three      |     return _ConnectionFairy._checkout(self)
broker_one        |     return _ConnectionRecord(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_one        |     self.__connect()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_one        |     pool.logger.debug("Error on connect(): %s", e)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_one        |     raise exc_value.with_traceback(exc_tb)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_one        |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_three      |     fairy = _ConnectionRecord.checkout(pool)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_three      |     rec = pool._do_get()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_three      |     self._dec_overflow()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_three      |     raise exc_value.with_traceback(exc_tb)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_three      |     return self._create_connection()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_three      |     return _ConnectionRecord(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_one        |     return dialect.connect(*cargs, **cparams)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_one        |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_one        |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_one        | sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_one        | 	Is the server running on that host and accepting TCP/IP connections?
broker_one        | 
broker_one        | (Background on this error at: https://sqlalche.me/e/20/e3q8)
broker_one        | Traceback (most recent call last):
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_one        |     self._dbapi_connection = engine.raw_connection()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_one        |     return self.pool.connect()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_one        |     return _ConnectionFairy._checkout(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_one        |     fairy = _ConnectionRecord.checkout(pool)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_one        |     rec = pool._do_get()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_one        |     self._dec_overflow()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_one        |     raise exc_value.with_traceback(exc_tb)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_one        |     return self._create_connection()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_one        |     return _ConnectionRecord(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_three      |     self.__connect()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_three      |     pool.logger.debug("Error on connect(): %s", e)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_three      |     raise exc_value.with_traceback(exc_tb)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_three      |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_three      |     return dialect.connect(*cargs, **cparams)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_three      |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_three      |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_three      | psycopg2.OperationalError: connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_three      | 	Is the server running on that host and accepting TCP/IP connections?
broker_three      | 
broker_three      | 
broker_three      | The above exception was the direct cause of the following exception:
broker_three      | 
broker_one        |     self.__connect()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_one        |     pool.logger.debug("Error on connect(): %s", e)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_one        |     raise exc_value.with_traceback(exc_tb)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_three      | Traceback (most recent call last):
broker_three      |   File "/app/./Brokers/BrokerWrapper.py", line 148, in <module>
broker_three      |     db.create_all()  # <--- create db object.
broker_three      |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 884, in create_all
broker_three      |     self._call_for_binds(bind_key, "create_all")
broker_three      |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 865, in _call_for_binds
broker_three      |     getattr(metadata, op_name)(bind=engine)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/schema.py", line 5581, in create_all
broker_three      |     bind._run_ddl_visitor(
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3225, in _run_ddl_visitor
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_two        |     self._dbapi_connection = engine.raw_connection()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_two        |     return self.pool.connect()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_two        |     return _ConnectionFairy._checkout(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_two        |     fairy = _ConnectionRecord.checkout(pool)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_two        |     rec = pool._do_get()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_two        |     self._dec_overflow()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_two        |     raise exc_value.with_traceback(exc_tb)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_two        |     return self._create_connection()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_one        |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_one        |     return dialect.connect(*cargs, **cparams)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_one        |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_one        |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_one        | psycopg2.OperationalError: connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_one        | 	Is the server running on that host and accepting TCP/IP connections?
broker_one        | 
broker_one        | 
broker_one        | The above exception was the direct cause of the following exception:
broker_one        | 
broker_one        | Traceback (most recent call last):
broker_one        |   File "/app/./Brokers/BrokerWrapper.py", line 148, in <module>
broker_one        |     db.create_all()  # <--- create db object.
broker_three      |     with self.begin() as conn:
broker_three      |   File "/usr/local/lib/python3.9/contextlib.py", line 119, in __enter__
broker_three      |     return next(self.gen)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 884, in create_all
broker_two        |     return _ConnectionRecord(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_two        |     self.__connect()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_two        |     pool.logger.debug("Error on connect(): %s", e)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_two        |     raise exc_value.with_traceback(exc_tb)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_two        |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_two        |     return dialect.connect(*cargs, **cparams)
broker_one        |     self._call_for_binds(bind_key, "create_all")
broker_one        |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 865, in _call_for_binds
broker_one        |     getattr(metadata, op_name)(bind=engine)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/schema.py", line 5581, in create_all
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_two        |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_two        |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_two        | psycopg2.OperationalError: connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_two        | 	Is the server running on that host and accepting TCP/IP connections?
broker_two        | 
broker_two        | 
broker_two        | The above exception was the direct cause of the following exception:
broker_two        | 
broker_two        | Traceback (most recent call last):
broker_two        |   File "/app/./Brokers/BrokerWrapper.py", line 148, in <module>
broker_two        |     db.create_all()  # <--- create db object.
broker_two        |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 884, in create_all
broker_two        |     self._call_for_binds(bind_key, "create_all")
broker_two        |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 865, in _call_for_binds
broker_two        |     getattr(metadata, op_name)(bind=engine)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/schema.py", line 5581, in create_all
broker_two        |     bind._run_ddl_visitor(
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3225, in _run_ddl_visitor
broker_two        |     with self.begin() as conn:
broker_two        |   File "/usr/local/lib/python3.9/contextlib.py", line 119, in __enter__
broker_two        |     return next(self.gen)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3215, in begin
broker_two        |     with self.connect() as conn:
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3251, in connect
broker_two        |     return self._connection_cls(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
broker_two        |     Connection._handle_dbapi_exception_noconnection(
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2413, in _handle_dbapi_exception_noconnection
broker_one        |     bind._run_ddl_visitor(
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3225, in _run_ddl_visitor
broker_one        |     with self.begin() as conn:
broker_one        |   File "/usr/local/lib/python3.9/contextlib.py", line 119, in __enter__
broker_one        |     return next(self.gen)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3215, in begin
broker_one        |     with self.connect() as conn:
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3251, in connect
broker_one        |     return self._connection_cls(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
broker_one        |     Connection._handle_dbapi_exception_noconnection(
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2413, in _handle_dbapi_exception_noconnection
broker_one        |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_one        |     self._dbapi_connection = engine.raw_connection()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_one        |     return self.pool.connect()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_one        |     return _ConnectionFairy._checkout(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_one        |     fairy = _ConnectionRecord.checkout(pool)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_one        |     rec = pool._do_get()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_two        |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_two        |     self._dbapi_connection = engine.raw_connection()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_two        |     return self.pool.connect()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_two        |     return _ConnectionFairy._checkout(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_two        |     fairy = _ConnectionRecord.checkout(pool)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_one        |     self._dec_overflow()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_one        |     raise exc_value.with_traceback(exc_tb)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_one        |     return self._create_connection()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_one        |     return _ConnectionRecord(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_one        |     self.__connect()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_one        |     pool.logger.debug("Error on connect(): %s", e)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_one        |     raise exc_value.with_traceback(exc_tb)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_one        |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_one        |     return dialect.connect(*cargs, **cparams)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_one        |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_one        |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_one        | sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_one        | 	Is the server running on that host and accepting TCP/IP connections?
broker_one        | 
broker_one        | (Background on this error at: https://sqlalche.me/e/20/e3q8)
broker_one        | Traceback (most recent call last):
broker_two        |     rec = pool._do_get()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_two        |     self._dec_overflow()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_two        |     raise exc_value.with_traceback(exc_tb)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_two        |     return self._create_connection()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_two        |     return _ConnectionRecord(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_one        |     self._dbapi_connection = engine.raw_connection()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_one        |     return self.pool.connect()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_one        |     return _ConnectionFairy._checkout(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_one        |     fairy = _ConnectionRecord.checkout(pool)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_one        |     rec = pool._do_get()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_one        |     self._dec_overflow()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_one        |     raise exc_value.with_traceback(exc_tb)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_one        |     return self._create_connection()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_one        |     return _ConnectionRecord(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_one        |     self.__connect()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_one        |     pool.logger.debug("Error on connect(): %s", e)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_one        |     raise exc_value.with_traceback(exc_tb)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_one        |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_two        |     self.__connect()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_two        |     pool.logger.debug("Error on connect(): %s", e)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_two        |     raise exc_value.with_traceback(exc_tb)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_two        |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_two        |     return dialect.connect(*cargs, **cparams)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_two        |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_two        |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_two        | sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_two        | 	Is the server running on that host and accepting TCP/IP connections?
broker_two        | 
broker_two        | (Background on this error at: https://sqlalche.me/e/20/e3q8)
broker_two        | Traceback (most recent call last):
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_two        |     self._dbapi_connection = engine.raw_connection()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_two        |     return self.pool.connect()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_two        |     return _ConnectionFairy._checkout(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_two        |     fairy = _ConnectionRecord.checkout(pool)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_two        |     rec = pool._do_get()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_one        |     return dialect.connect(*cargs, **cparams)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_one        |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_one        |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_one        | psycopg2.OperationalError: connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_one        | 	Is the server running on that host and accepting TCP/IP connections?
broker_one        | 
broker_one        | 
broker_one        | The above exception was the direct cause of the following exception:
broker_one        | 
broker_one        | Traceback (most recent call last):
broker_one        |   File "/app/./Brokers/BrokerWrapper.py", line 148, in <module>
broker_one        |     db.create_all()  # <--- create db object.
broker_one        |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 884, in create_all
broker_one        |     self._call_for_binds(bind_key, "create_all")
broker_one        |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 865, in _call_for_binds
broker_one        |     getattr(metadata, op_name)(bind=engine)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/schema.py", line 5581, in create_all
broker_one        |     bind._run_ddl_visitor(
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3225, in _run_ddl_visitor
broker_one        |     with self.begin() as conn:
broker_one        |   File "/usr/local/lib/python3.9/contextlib.py", line 119, in __enter__
broker_one        |     return next(self.gen)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3215, in begin
broker_one        |     with self.connect() as conn:
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3251, in connect
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3215, in begin
broker_three      |     with self.connect() as conn:
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3251, in connect
broker_three      |     return self._connection_cls(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
broker_three      |     Connection._handle_dbapi_exception_noconnection(
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2413, in _handle_dbapi_exception_noconnection
broker_three      |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_three      |     self._dbapi_connection = engine.raw_connection()
broker_one        |     return self._connection_cls(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
broker_one        |     Connection._handle_dbapi_exception_noconnection(
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2413, in _handle_dbapi_exception_noconnection
broker_one        |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_one        |     self._dbapi_connection = engine.raw_connection()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_one        |     return self.pool.connect()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_one        |     return _ConnectionFairy._checkout(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_one        |     fairy = _ConnectionRecord.checkout(pool)
broker_two        |     self._dec_overflow()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_two        |     raise exc_value.with_traceback(exc_tb)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_two        |     return self._create_connection()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_two        |     return _ConnectionRecord(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_two        |     self.__connect()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_two        |     pool.logger.debug("Error on connect(): %s", e)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_two        |     raise exc_value.with_traceback(exc_tb)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_two        |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_two        |     return dialect.connect(*cargs, **cparams)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_two        |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_two        |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_two        | psycopg2.OperationalError: connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_two        | 	Is the server running on that host and accepting TCP/IP connections?
broker_two        | 
broker_two        | 
broker_two        | The above exception was the direct cause of the following exception:
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_three      |     return self.pool.connect()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_three      |     return _ConnectionFairy._checkout(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_three      |     fairy = _ConnectionRecord.checkout(pool)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_three      |     rec = pool._do_get()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_two        | 
broker_two        | Traceback (most recent call last):
broker_two        |   File "/app/./Brokers/BrokerWrapper.py", line 148, in <module>
broker_two        |     db.create_all()  # <--- create db object.
broker_two        |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 884, in create_all
broker_two        |     self._call_for_binds(bind_key, "create_all")
broker_two        |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 865, in _call_for_binds
broker_two        |     getattr(metadata, op_name)(bind=engine)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/schema.py", line 5581, in create_all
broker_two        |     bind._run_ddl_visitor(
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3225, in _run_ddl_visitor
broker_two        |     with self.begin() as conn:
broker_two        |   File "/usr/local/lib/python3.9/contextlib.py", line 119, in __enter__
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_one        |     rec = pool._do_get()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_one        |     self._dec_overflow()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_one        |     raise exc_value.with_traceback(exc_tb)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_one        |     return self._create_connection()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_one        |     return _ConnectionRecord(self)
broker_two        |     return next(self.gen)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3215, in begin
broker_two        |     with self.connect() as conn:
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3251, in connect
broker_two        |     return self._connection_cls(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
broker_two        |     Connection._handle_dbapi_exception_noconnection(
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2413, in _handle_dbapi_exception_noconnection
broker_two        |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_one        |     self.__connect()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_one        |     pool.logger.debug("Error on connect(): %s", e)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_one        |     raise exc_value.with_traceback(exc_tb)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_one        |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_one        |     return dialect.connect(*cargs, **cparams)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_one        |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_two        |     self._dbapi_connection = engine.raw_connection()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_two        |     return self.pool.connect()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_two        |     return _ConnectionFairy._checkout(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_two        |     fairy = _ConnectionRecord.checkout(pool)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_two        |     rec = pool._do_get()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_two        |     self._dec_overflow()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_two        |     raise exc_value.with_traceback(exc_tb)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_two        |     return self._create_connection()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_two        |     return _ConnectionRecord(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_two        |     self.__connect()
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_two        |     pool.logger.debug("Error on connect(): %s", e)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_one        |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_three      |     self._dec_overflow()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_three      |     raise exc_value.with_traceback(exc_tb)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_three      |     return self._create_connection()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_three      |     return _ConnectionRecord(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_three      |     self.__connect()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_three      |     pool.logger.debug("Error on connect(): %s", e)
broker_one        | sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_one        | 	Is the server running on that host and accepting TCP/IP connections?
broker_one        | 
broker_one        | (Background on this error at: https://sqlalche.me/e/20/e3q8)
broker_one        | Traceback (most recent call last):
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_one        |     self._dbapi_connection = engine.raw_connection()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_one        |     return self.pool.connect()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_one        |     return _ConnectionFairy._checkout(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_one        |     fairy = _ConnectionRecord.checkout(pool)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_one        |     rec = pool._do_get()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_one        |     self._dec_overflow()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_one        |     raise exc_value.with_traceback(exc_tb)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_one        |     return self._create_connection()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_two        |     raise exc_value.with_traceback(exc_tb)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_two        |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_two        |     return dialect.connect(*cargs, **cparams)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_two        |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_two        |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_two        |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_two        | sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_one        |     return _ConnectionRecord(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_one        |     self.__connect()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_one        |     pool.logger.debug("Error on connect(): %s", e)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_one        |     raise exc_value.with_traceback(exc_tb)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_one        |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_one        |     return dialect.connect(*cargs, **cparams)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_one        |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_one        |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_two        | 	Is the server running on that host and accepting TCP/IP connections?
broker_two        | 
broker_two        | (Background on this error at: https://sqlalche.me/e/20/e3q8)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_three      |     raise exc_value.with_traceback(exc_tb)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_three      |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_three      |     return dialect.connect(*cargs, **cparams)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_one        | psycopg2.OperationalError: connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_one        | 	Is the server running on that host and accepting TCP/IP connections?
broker_one        | 
broker_one        | 
broker_one        | The above exception was the direct cause of the following exception:
broker_one        | 
broker_one        | Traceback (most recent call last):
broker_one        |   File "/app/./Brokers/BrokerWrapper.py", line 148, in <module>
broker_one        |     db.create_all()  # <--- create db object.
broker_one        |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 884, in create_all
broker_one        |     self._call_for_binds(bind_key, "create_all")
broker_one        |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 865, in _call_for_binds
broker_one        |     getattr(metadata, op_name)(bind=engine)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/schema.py", line 5581, in create_all
broker_one        |     bind._run_ddl_visitor(
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3225, in _run_ddl_visitor
broker_one        |     with self.begin() as conn:
broker_one        |   File "/usr/local/lib/python3.9/contextlib.py", line 119, in __enter__
broker_one        |     return next(self.gen)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3215, in begin
broker_one        |     with self.connect() as conn:
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3251, in connect
broker_one        |     return self._connection_cls(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
broker_one        |     Connection._handle_dbapi_exception_noconnection(
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2413, in _handle_dbapi_exception_noconnection
broker_one        |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_one        |     self._dbapi_connection = engine.raw_connection()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_one        |     return self.pool.connect()
broker_three      |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_three      |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_three      | sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_three      | 	Is the server running on that host and accepting TCP/IP connections?
broker_three      | 
broker_three      | (Background on this error at: https://sqlalche.me/e/20/e3q8)
broker_three      | Traceback (most recent call last):
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_three      |     self._dbapi_connection = engine.raw_connection()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_three      |     return self.pool.connect()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_three      |     return _ConnectionFairy._checkout(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_three      |     fairy = _ConnectionRecord.checkout(pool)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_one        |     return _ConnectionFairy._checkout(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_one        |     fairy = _ConnectionRecord.checkout(pool)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_one        |     rec = pool._do_get()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_one        |     self._dec_overflow()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_one        |     raise exc_value.with_traceback(exc_tb)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_three      |     rec = pool._do_get()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_three      |     self._dec_overflow()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_three      |     raise exc_value.with_traceback(exc_tb)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_three      |     return self._create_connection()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_three      |     return _ConnectionRecord(self)
broker_one        |     return self._create_connection()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_one        |     return _ConnectionRecord(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_one        |     self.__connect()
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_one        |     pool.logger.debug("Error on connect(): %s", e)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_one        |     raise exc_value.with_traceback(exc_tb)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_one        |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_one        |     return dialect.connect(*cargs, **cparams)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_one        |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_one        |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_one        |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_one        | sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_one        | 	Is the server running on that host and accepting TCP/IP connections?
broker_one        | 
broker_one        | (Background on this error at: https://sqlalche.me/e/20/e3q8)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_three      |     self.__connect()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_three      |     pool.logger.debug("Error on connect(): %s", e)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_three      |     raise exc_value.with_traceback(exc_tb)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_three      |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_three      |     return dialect.connect(*cargs, **cparams)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_three      |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_three      |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_three      | psycopg2.OperationalError: connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_three      | 	Is the server running on that host and accepting TCP/IP connections?
broker_three      | 
broker_three      | 
broker_three      | The above exception was the direct cause of the following exception:
broker_three      | 
broker_three      | Traceback (most recent call last):
broker_three      |   File "/app/./Brokers/BrokerWrapper.py", line 148, in <module>
broker_three      |     db.create_all()  # <--- create db object.
broker_three      |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 884, in create_all
broker_three      |     self._call_for_binds(bind_key, "create_all")
broker_three      |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 865, in _call_for_binds
broker_three      |     getattr(metadata, op_name)(bind=engine)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/schema.py", line 5581, in create_all
broker_three      |     bind._run_ddl_visitor(
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3225, in _run_ddl_visitor
broker_three      |     with self.begin() as conn:
broker_three      |   File "/usr/local/lib/python3.9/contextlib.py", line 119, in __enter__
broker_three      |     return next(self.gen)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3215, in begin
broker_three      |     with self.connect() as conn:
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3251, in connect
broker_three      |     return self._connection_cls(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
broker_three      |     Connection._handle_dbapi_exception_noconnection(
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2413, in _handle_dbapi_exception_noconnection
broker_three      |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_three      |     self._dbapi_connection = engine.raw_connection()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_three      |     return self.pool.connect()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_three      |     return _ConnectionFairy._checkout(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_three      |     fairy = _ConnectionRecord.checkout(pool)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_three      |     rec = pool._do_get()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_three      |     self._dec_overflow()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_three      |     raise exc_value.with_traceback(exc_tb)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_three      |     return self._create_connection()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_three      |     return _ConnectionRecord(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_three      |     self.__connect()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_three      |     pool.logger.debug("Error on connect(): %s", e)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_three      |     raise exc_value.with_traceback(exc_tb)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_three      |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_three      |     return dialect.connect(*cargs, **cparams)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_three      |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_three      |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_three      | sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_three      | 	Is the server running on that host and accepting TCP/IP connections?
broker_three      | 
broker_three      | (Background on this error at: https://sqlalche.me/e/20/e3q8)
broker_three      | Traceback (most recent call last):
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_three      |     self._dbapi_connection = engine.raw_connection()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_three      |     return self.pool.connect()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_three      |     return _ConnectionFairy._checkout(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_three      |     fairy = _ConnectionRecord.checkout(pool)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_three      |     rec = pool._do_get()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_three      |     self._dec_overflow()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_three      |     raise exc_value.with_traceback(exc_tb)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_three      |     return self._create_connection()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_three      |     return _ConnectionRecord(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_three      |     self.__connect()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_three      |     pool.logger.debug("Error on connect(): %s", e)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_three      |     raise exc_value.with_traceback(exc_tb)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_three      |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_three      |     return dialect.connect(*cargs, **cparams)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_three      |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_three      |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_three      | psycopg2.OperationalError: connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_three      | 	Is the server running on that host and accepting TCP/IP connections?
broker_three      | 
broker_three      | 
broker_three      | The above exception was the direct cause of the following exception:
broker_three      | 
broker_three      | Traceback (most recent call last):
broker_three      |   File "/app/./Brokers/BrokerWrapper.py", line 148, in <module>
broker_three      |     db.create_all()  # <--- create db object.
broker_three      |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 884, in create_all
broker_three      |     self._call_for_binds(bind_key, "create_all")
broker_three      |   File "/usr/local/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 865, in _call_for_binds
broker_three      |     getattr(metadata, op_name)(bind=engine)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/sql/schema.py", line 5581, in create_all
broker_three      |     bind._run_ddl_visitor(
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3225, in _run_ddl_visitor
broker_three      |     with self.begin() as conn:
broker_three      |   File "/usr/local/lib/python3.9/contextlib.py", line 119, in __enter__
broker_three      |     return next(self.gen)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3215, in begin
broker_three      |     with self.connect() as conn:
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3251, in connect
broker_three      |     return self._connection_cls(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
broker_three      |     Connection._handle_dbapi_exception_noconnection(
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2413, in _handle_dbapi_exception_noconnection
broker_three      |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
broker_three      |     self._dbapi_connection = engine.raw_connection()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3275, in raw_connection
broker_three      |     return self.pool.connect()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 455, in connect
broker_three      |     return _ConnectionFairy._checkout(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1271, in _checkout
broker_three      |     fairy = _ConnectionRecord.checkout(pool)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 719, in checkout
broker_three      |     rec = pool._do_get()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
broker_three      |     self._dec_overflow()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_three      |     raise exc_value.with_traceback(exc_tb)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 166, in _do_get
broker_three      |     return self._create_connection()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 396, in _create_connection
broker_three      |     return _ConnectionRecord(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 681, in __init__
broker_three      |     self.__connect()
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 906, in __connect
broker_three      |     pool.logger.debug("Error on connect(): %s", e)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 147, in __exit__
broker_three      |     raise exc_value.with_traceback(exc_tb)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
broker_three      |     self.dbapi_connection = connection = pool._invoke_creator(self)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 640, in connect
broker_three      |     return dialect.connect(*cargs, **cparams)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 580, in connect
broker_three      |     return self.loaded_dbapi.connect(*cargs, **cparams)
broker_three      |   File "/usr/local/lib/python3.9/site-packages/psycopg2/__init__.py", line 122, in connect
broker_three      |     conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
broker_three      | sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "127.0.0.1", port 5432 failed: Connection refused
broker_three      | 	Is the server running on that host and accepting TCP/IP connections?
broker_three      | 
broker_three      | (Background on this error at: https://sqlalche.me/e/20/e3q8)
